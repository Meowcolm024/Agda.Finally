<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Normalization</title>
  <link rel="stylesheet" href="./static/Agda.css">
  <link rel="stylesheet" href="./static/style.css">
</head>

<body>
  <div class="container">
    <nav class="sidebar">
      <a href="./">
        <h2>Agda, Finally...</h2>
      </a>
      <div class="section">
        <h3>STLC</h3>
        <ul>
          <li>
            <a href="stlc.base.html" class="">
              Basics
            </a>
          </li>
          <li>
            <a href="stlc.prop.html" class="">
              Properties
            </a>
          </li>
          <li>
            <a href="stlc.bigstep.html" class="">
              Bigstep
            </a>
          </li>
          <li>
            <a href="stlc.natural.html" class="">
              Natural Semantics
            </a>
          </li>
          <li>
            <a href="stlc.norm.html" class="active">
              Normalization
            </a>
          </li>
          <li>
            <a href="stlc.soundness.html" class="">
              Semantic Typing
            </a>
          </li>
          <li>
            <a href="stlc.strengthen.html" class="">
              Strengthening
            </a>
          </li>
          <li>
            <a href="stlc.subst.html" class="">
              Substitution
            </a>
          </li>
          <li>
            <a href="stlc.clos.html" class="">
              Closure Calculus
            </a>
          </li>
        </ul>
      </div>
      <div class="section">
        <h3>Extra</h3>
        <ul>
          <li>
            <a href="extra.unscoped.html" class="">
              Unscoped
            </a>
          </li>
          <li>
            <a href="extra.sigma.html" class="">
              Explicit Substitutions
            </a>
          </li>
          <li>
            <a href="extra.mu.html" class="">
              Recursive Types
            </a>
          </li>
          <li>
            <a href="extra.systemf.html" class="">
              System F
            </a>
          </li>
        </ul>
      </div>
      <div class="section">
        <h3>Misc</h3>
        <ul>
          <li>
            <a href="finally.html" class="">
              Test
            </a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/Meowcolm024/Agda.Finally">
        <h3>Github</h3>
      </a>
    </nav>

    <main class="content">
      <h1>Normalization</h1>
      <blockquote>
<p>This part mainly follows the note <a href="https://cs.au.dk/~birke/papers/AnIntroductionToLogicalRelations.pdf">An Introduction to Logical Relations</a></p>
<p>You may also want to checkout the lecture note <a href="https://www.cs.uoregon.edu/research/summerschool/summer23/_lectures/Logical_Relations_Notes.pdf">OPLSS 2023: Logical Relations</a></p>
<p>Or the chapter <a href="https://softwarefoundations.cis.upenn.edu/plf-current/Norm.html">Normalization of STLC</a> from Programming Language Foundations</p>
</blockquote>
<pre class="Agda"><a id="512" class="Keyword">module</a> <a id="519" href="stlc.norm.html" class="Module">stlc.norm</a> <a id="529" class="Keyword">where</a>
</pre>
<p>Here we consider the (weak) normalization of stlc. Please refer to the notes above for motivation and explanation :P.</p>
<h2>Imports</h2>
<pre class="Agda"><a id="679" class="Keyword">open</a> <a id="684" class="Keyword">import</a> <a id="691" href="stlc.base.html" class="Module">stlc.base</a>
<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="stlc.prop.html" class="Module">stlc.prop</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="stlc.subst.html" class="Module">stlc.subst</a>
<a id="746" class="Keyword">open</a> <a id="751" href="stlc.base.html#5542" class="Module">multistep</a>

<a id="762" class="Keyword">import</a> <a id="769" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="807" class="Symbol">as</a> <a id="810" class="Module">Eq</a>
<a id="813" class="Keyword">open</a> <a id="818" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="821" class="Keyword">using</a> <a id="827" class="Symbol">(</a><a id="828" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_â‰¡_</a><a id="831" class="Symbol">;</a> <a id="833" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="837" class="Symbol">)</a>
<a id="839" class="Keyword">open</a> <a id="844" class="Keyword">import</a> <a id="851" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="860" class="Keyword">using</a> <a id="866" class="Symbol">(</a><a id="867" href="Agda.Builtin.Nat.html#203" class="Datatype">â„•</a><a id="868" class="Symbol">;</a> <a id="870" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="874" class="Symbol">;</a> <a id="876" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="879" class="Symbol">)</a>
<a id="881" class="Keyword">open</a> <a id="886" class="Keyword">import</a> <a id="893" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="902" class="Keyword">using</a> <a id="908" class="Symbol">(</a><a id="909" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a><a id="912" class="Symbol">;</a> <a id="914" href="Data.Fin.Base.html#1154" class="InductiveConstructor">zero</a><a id="918" class="Symbol">;</a> <a id="920" href="Data.Fin.Base.html#1175" class="InductiveConstructor">suc</a><a id="923" class="Symbol">)</a>
<a id="925" class="Keyword">open</a> <a id="930" class="Keyword">import</a> <a id="937" href="Data.Product.html" class="Module">Data.Product</a> <a id="950" class="Keyword">using</a> <a id="956" class="Symbol">(</a><a id="957" href="Data.Product.Base.html#1618" class="Function Operator">_Ã—_</a><a id="960" class="Symbol">;</a> <a id="962" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="965" class="Symbol">;</a> <a id="967" href="Data.Product.Base.html#1371" class="Function">âˆƒ-syntax</a><a id="975" class="Symbol">;</a> <a id="977" href="Data.Product.Base.html#1244" class="Function">Î£-syntax</a><a id="985" class="Symbol">)</a>
<a id="987" class="Keyword">open</a> <a id="992" class="Keyword">import</a> <a id="999" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="1008" class="Keyword">using</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Data.Sum.Base.html#625" class="Datatype Operator">_âŠ_</a><a id="1018" class="Symbol">;</a> <a id="1020" href="Data.Sum.Base.html#675" class="InductiveConstructor">injâ‚</a><a id="1024" class="Symbol">;</a> <a id="1026" href="Data.Sum.Base.html#700" class="InductiveConstructor">injâ‚‚</a><a id="1030" class="Symbol">)</a>
<a id="1032" class="Keyword">open</a> <a id="1037" class="Keyword">import</a> <a id="1044" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1061" class="Keyword">using</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">Â¬_</a><a id="1070" class="Symbol">;</a> <a id="1072" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a><a id="1085" class="Symbol">)</a>
<a id="1087" class="Keyword">open</a> <a id="1092" class="Keyword">import</a> <a id="1099" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="1110" class="Keyword">using</a> <a id="1116" class="Symbol">(</a><a id="1117" href="Data.Empty.html#914" class="Function">âŠ¥</a><a id="1118" class="Symbol">;</a> <a id="1120" href="Data.Empty.html#1069" class="Function">âŠ¥-elim</a><a id="1126" class="Symbol">)</a>
</pre>
<h2>Definitions</h2>
<p>A term halts if there exists a reduction sequence that reduces it to value.</p>
<pre class="Agda"><a id="1234" class="Keyword">data</a> <a id="Halts"></a><a id="1239" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="1245" class="Symbol">{</a><a id="1246" href="stlc.norm.html#1246" class="Bound">n</a><a id="1247" class="Symbol">}</a> <a id="1249" class="Symbol">(</a><a id="1250" href="stlc.norm.html#1250" class="Bound">M</a> <a id="1252" class="Symbol">:</a> <a id="1254" href="stlc.base.html#932" class="Datatype">Term</a> <a id="1259" href="stlc.norm.html#1246" class="Bound">n</a><a id="1260" class="Symbol">)</a> <a id="1262" class="Symbol">:</a> <a id="1264" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1268" class="Keyword">where</a>
  <a id="Halts.halts"></a><a id="1276" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="1282" class="Symbol">:</a> <a id="1284" class="Symbol">âˆ€</a> <a id="1286" class="Symbol">{</a><a id="1287" href="stlc.norm.html#1287" class="Bound">N</a><a id="1288" class="Symbol">}</a>
    <a id="1294" class="Symbol">â†’</a> <a id="1296" href="stlc.norm.html#1250" class="Bound">M</a> <a id="1298" href="stlc.base.html#5634" class="Datatype Operator">â€”â†’*</a> <a id="1302" href="stlc.norm.html#1287" class="Bound">N</a>
    <a id="1308" class="Symbol">â†’</a> <a id="1310" href="stlc.base.html#4705" class="Datatype">Value</a> <a id="1316" href="stlc.norm.html#1287" class="Bound">N</a>
      <a id="1324" class="Comment">--------</a>
    <a id="1337" class="Symbol">â†’</a> <a id="1339" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="1345" href="stlc.norm.html#1250" class="Bound">M</a>
</pre>
<p>The logical relation for normalization:</p>
<pre class="Agda"><a id="ğ’©_âŸ¦_âŸ§"></a><a id="1401" href="stlc.norm.html#1401" class="Function Operator">ğ’©_âŸ¦_âŸ§</a> <a id="1407" class="Symbol">:</a> <a id="1409" href="stlc.base.html#597" class="Datatype">Type</a> <a id="1414" class="Symbol">â†’</a> <a id="1416" href="stlc.base.html#932" class="Datatype">Term</a> <a id="1421" class="Number">0</a> <a id="1423" class="Symbol">â†’</a> <a id="1425" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1429" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1431" href="stlc.base.html#616" class="InductiveConstructor">Bool</a>  <a id="1437" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1439" href="stlc.norm.html#1439" class="Bound">M</a> <a id="1441" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="1443" class="Symbol">=</a> <a id="1445" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="1447" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="1449" href="stlc.norm.html#1439" class="Bound">M</a> <a id="1451" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="1453" href="stlc.base.html#616" class="InductiveConstructor">Bool</a>  <a id="1459" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1461" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="1467" href="stlc.norm.html#1439" class="Bound">M</a>
<a id="1469" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1471" href="stlc.norm.html#1471" class="Bound">A</a> <a id="1473" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="1475" href="stlc.norm.html#1475" class="Bound">B</a> <a id="1477" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1479" href="stlc.norm.html#1479" class="Bound">M</a> <a id="1481" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="1483" class="Symbol">=</a> <a id="1485" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="1487" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="1489" href="stlc.norm.html#1479" class="Bound">M</a> <a id="1491" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="1493" href="stlc.norm.html#1471" class="Bound">A</a> <a id="1495" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="1497" href="stlc.norm.html#1475" class="Bound">B</a> <a id="1499" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1501" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="1507" href="stlc.norm.html#1479" class="Bound">M</a> <a id="1509" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1511" class="Symbol">(âˆ€</a> <a id="1514" class="Symbol">{</a><a id="1515" href="stlc.norm.html#1515" class="Bound">N</a><a id="1516" class="Symbol">}</a> <a id="1518" class="Symbol">â†’</a> <a id="1520" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1522" href="stlc.norm.html#1471" class="Bound">A</a> <a id="1524" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1526" href="stlc.norm.html#1515" class="Bound">N</a> <a id="1528" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="1530" class="Symbol">â†’</a> <a id="1532" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1534" href="stlc.norm.html#1475" class="Bound">B</a> <a id="1536" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1538" href="stlc.norm.html#1479" class="Bound">M</a> <a id="1540" href="stlc.base.html#1081" class="InductiveConstructor Operator">Â·</a> <a id="1542" href="stlc.norm.html#1515" class="Bound">N</a> <a id="1544" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a><a id="1545" class="Symbol">)</a>
</pre>
<p>Substitution of normalizing terms:</p>
<pre class="Agda"><a id="_âŠ¨_"></a><a id="1596" href="stlc.norm.html#1596" class="Function Operator">_âŠ¨_</a> <a id="1600" class="Symbol">:</a> <a id="1602" class="Symbol">âˆ€</a> <a id="1604" class="Symbol">{</a><a id="1605" href="stlc.norm.html#1605" class="Bound">n</a><a id="1606" class="Symbol">}</a> <a id="1608" class="Symbol">â†’</a> <a id="1610" class="Symbol">(</a><a id="1611" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a> <a id="1615" href="stlc.norm.html#1605" class="Bound">n</a> <a id="1617" class="Symbol">â†’</a> <a id="1619" href="stlc.base.html#932" class="Datatype">Term</a> <a id="1624" class="Number">0</a><a id="1625" class="Symbol">)</a> <a id="1627" class="Symbol">â†’</a> <a id="1629" href="stlc.base.html#1948" class="Datatype">Context</a> <a id="1637" href="stlc.norm.html#1605" class="Bound">n</a> <a id="1639" class="Symbol">â†’</a> <a id="1641" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1645" href="stlc.norm.html#1645" class="Bound">Ïƒ</a> <a id="1647" href="stlc.norm.html#1596" class="Function Operator">âŠ¨</a> <a id="1649" href="stlc.norm.html#1649" class="Bound">Î“</a> <a id="1651" class="Symbol">=</a> <a id="1653" class="Symbol">âˆ€</a> <a id="1655" class="Symbol">{</a><a id="1656" href="stlc.norm.html#1656" class="Bound">x</a> <a id="1658" href="stlc.norm.html#1658" class="Bound">B</a><a id="1659" class="Symbol">}</a> <a id="1661" class="Symbol">â†’</a> <a id="1663" href="stlc.norm.html#1649" class="Bound">Î“</a> <a id="1665" href="stlc.base.html#2176" class="Datatype Operator">âˆ‹</a> <a id="1667" href="stlc.norm.html#1656" class="Bound">x</a> <a id="1669" href="stlc.base.html#2176" class="Datatype Operator">â¦‚</a> <a id="1671" href="stlc.norm.html#1658" class="Bound">B</a> <a id="1673" class="Symbol">â†’</a> <a id="1675" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1677" href="stlc.norm.html#1658" class="Bound">B</a> <a id="1679" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1681" href="stlc.norm.html#1645" class="Bound">Ïƒ</a> <a id="1683" href="stlc.norm.html#1656" class="Bound">x</a> <a id="1685" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
</pre>
<h2>Auxiliary Lemmas</h2>
<p>Normalizing terms are well typed (directly encoded in the logical predicate).</p>
<pre class="Agda"><a id="ğ’©â†’âŠ¢"></a><a id="1800" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="1804" class="Symbol">:</a> <a id="1806" class="Symbol">âˆ€</a> <a id="1808" class="Symbol">{</a><a id="1809" href="stlc.norm.html#1809" class="Bound">M</a> <a id="1811" href="stlc.norm.html#1811" class="Bound">A</a><a id="1812" class="Symbol">}</a> <a id="1814" class="Symbol">â†’</a> <a id="1816" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="1818" href="stlc.norm.html#1811" class="Bound">A</a> <a id="1820" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="1822" href="stlc.norm.html#1809" class="Bound">M</a> <a id="1824" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="1826" class="Symbol">â†’</a> <a id="1828" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="1830" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="1832" href="stlc.norm.html#1809" class="Bound">M</a> <a id="1834" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="1836" href="stlc.norm.html#1811" class="Bound">A</a>
<a id="1838" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="1842" class="Symbol">{</a><a id="1843" class="Argument">A</a> <a id="1845" class="Symbol">=</a> <a id="1847" href="stlc.base.html#616" class="InductiveConstructor">Bool</a><a id="1851" class="Symbol">}</a>  <a id="1854" class="Symbol">(</a><a id="1855" href="stlc.norm.html#1855" class="Bound">âŠ¢M</a> <a id="1858" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1860" class="Symbol">_)</a> <a id="1863" class="Symbol">=</a> <a id="1865" href="stlc.norm.html#1855" class="Bound">âŠ¢M</a>
<a id="1868" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="1872" class="Symbol">{</a><a id="1873" class="Argument">A</a> <a id="1875" class="Symbol">=</a> <a id="1877" href="stlc.norm.html#1877" class="Bound">A</a> <a id="1879" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="1881" href="stlc.norm.html#1881" class="Bound">B</a><a id="1882" class="Symbol">}</a> <a id="1884" class="Symbol">(</a><a id="1885" href="stlc.norm.html#1885" class="Bound">âŠ¢M</a> <a id="1888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1890" class="Symbol">_)</a> <a id="1893" class="Symbol">=</a> <a id="1895" href="stlc.norm.html#1885" class="Bound">âŠ¢M</a>
</pre>
<p>The substitution that closes the term with normalizing term is well typed.</p>
<p>Note that, since we are using <em>parallel substitution</em>, there is no need to define
extra structures of simultaneous substitution for single substitution like in 
the normalization chapter of <a href="https://softwarefoundations.cis.upenn.edu/plf-current/Norm.html"><em>PLF</em></a>.</p>
<pre class="Agda"><a id="âŠ¢subst"></a><a id="2252" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="2259" class="Symbol">:</a> <a id="2261" class="Symbol">âˆ€</a> <a id="2263" class="Symbol">{</a><a id="2264" href="stlc.norm.html#2264" class="Bound">n</a><a id="2265" class="Symbol">}</a> <a id="2267" class="Symbol">{</a><a id="2268" href="stlc.norm.html#2268" class="Bound">Î“</a> <a id="2270" class="Symbol">:</a> <a id="2272" href="stlc.base.html#1948" class="Datatype">Context</a> <a id="2280" href="stlc.norm.html#2264" class="Bound">n</a><a id="2281" class="Symbol">}</a> <a id="2283" class="Symbol">{</a><a id="2284" href="stlc.norm.html#2284" class="Bound">Ïƒ</a> <a id="2286" href="stlc.norm.html#2286" class="Bound">M</a> <a id="2288" href="stlc.norm.html#2288" class="Bound">A</a><a id="2289" class="Symbol">}</a>
  <a id="2293" class="Symbol">â†’</a> <a id="2295" href="stlc.norm.html#2268" class="Bound">Î“</a> <a id="2297" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="2299" href="stlc.norm.html#2286" class="Bound">M</a> <a id="2301" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="2303" href="stlc.norm.html#2288" class="Bound">A</a> <a id="2305" class="Symbol">â†’</a> <a id="2307" href="stlc.norm.html#2284" class="Bound">Ïƒ</a> <a id="2309" href="stlc.norm.html#1596" class="Function Operator">âŠ¨</a> <a id="2311" href="stlc.norm.html#2268" class="Bound">Î“</a>
    <a id="2317" class="Comment">------------------</a>
  <a id="2338" class="Symbol">â†’</a> <a id="2340" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="2342" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="2344" href="stlc.base.html#3341" class="Function">subst</a> <a id="2350" href="stlc.norm.html#2284" class="Bound">Ïƒ</a> <a id="2352" href="stlc.norm.html#2286" class="Bound">M</a> <a id="2354" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="2356" href="stlc.norm.html#2288" class="Bound">A</a>
<a id="2358" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="2365" href="stlc.norm.html#2365" class="Bound">âŠ¢M</a> <a id="2368" href="stlc.norm.html#2368" class="Bound">ÏƒâŠ¨Î“</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="stlc.prop.html#2113" class="Function">ty-subst</a> <a id="2383" href="stlc.norm.html#2365" class="Bound">âŠ¢M</a> <a id="2386" class="Symbol">(Î»</a> <a id="2389" href="stlc.norm.html#2389" class="Bound">x</a> <a id="2391" class="Symbol">â†’</a> <a id="2393" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="2397" class="Symbol">(</a><a id="2398" href="stlc.norm.html#2368" class="Bound">ÏƒâŠ¨Î“</a> <a id="2402" href="stlc.norm.html#2389" class="Bound">x</a><a id="2403" class="Symbol">))</a>
</pre>
<p>Small step preserves halting (at both directions):</p>
<pre class="Agda"><a id="â€”â†’-Halts"></a><a id="2471" href="stlc.norm.html#2471" class="Function">â€”â†’-Halts</a> <a id="2480" class="Symbol">:</a> <a id="2482" class="Symbol">âˆ€</a> <a id="2484" class="Symbol">{</a><a id="2485" href="stlc.norm.html#2485" class="Bound">M</a> <a id="2487" href="stlc.norm.html#2487" class="Bound">M&#39;</a> <a id="2490" class="Symbol">:</a> <a id="2492" href="stlc.base.html#932" class="Datatype">Term</a> <a id="2497" class="Number">0</a><a id="2498" class="Symbol">}</a> <a id="2500" class="Symbol">â†’</a> <a id="2502" href="stlc.norm.html#2485" class="Bound">M</a> <a id="2504" href="stlc.base.html#4875" class="Datatype Operator">â€”â†’</a> <a id="2507" href="stlc.norm.html#2487" class="Bound">M&#39;</a> <a id="2510" class="Symbol">â†’</a> <a id="2512" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="2518" href="stlc.norm.html#2485" class="Bound">M</a> <a id="2520" class="Symbol">â†’</a> <a id="2522" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="2528" href="stlc.norm.html#2487" class="Bound">M&#39;</a>
<a id="2531" href="stlc.norm.html#2471" class="Function">â€”â†’-Halts</a> <a id="2540" href="stlc.norm.html#2540" class="Bound">Mâ€”â†’M&#39;</a> <a id="2546" class="Symbol">(</a><a id="2547" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2553" class="Symbol">(_</a> <a id="2556" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="2557" class="Symbol">)</a> <a id="2559" href="stlc.norm.html#2559" class="Bound">VN</a><a id="2561" class="Symbol">)</a>                    <a id="2582" class="Symbol">=</a> <a id="2584" href="Data.Empty.html#1069" class="Function">âŠ¥-elim</a> <a id="2591" class="Symbol">(</a><a id="2592" href="stlc.prop.html#5010" class="Function">V-Â¬â€”â†’</a> <a id="2598" href="stlc.norm.html#2559" class="Bound">VN</a> <a id="2601" href="stlc.norm.html#2540" class="Bound">Mâ€”â†’M&#39;</a><a id="2606" class="Symbol">)</a>
<a id="2608" href="stlc.norm.html#2471" class="Function">â€”â†’-Halts</a> <a id="2617" href="stlc.norm.html#2617" class="Bound">Mâ€”â†’M&#39;</a> <a id="2623" class="Symbol">(</a><a id="2624" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2630" class="Symbol">(_</a> <a id="2633" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2637" href="stlc.norm.html#2637" class="Bound">Mâ€”â†’M&#39;&#39;</a> <a id="2644" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="2646" href="stlc.norm.html#2646" class="Bound">M&#39;&#39;â€”â†’*N</a><a id="2653" class="Symbol">)</a> <a id="2655" href="stlc.norm.html#2655" class="Bound">VN</a><a id="2657" class="Symbol">)</a> <a id="2659" class="Keyword">rewrite</a> <a id="2667" href="stlc.prop.html#5186" class="Function">â€”â†’-determ</a> <a id="2677" href="stlc.norm.html#2617" class="Bound">Mâ€”â†’M&#39;</a> <a id="2683" href="stlc.norm.html#2637" class="Bound">Mâ€”â†’M&#39;&#39;</a> <a id="2690" class="Symbol">=</a> <a id="2692" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2698" href="stlc.norm.html#2646" class="Bound">M&#39;&#39;â€”â†’*N</a> <a id="2706" href="stlc.norm.html#2655" class="Bound">VN</a>

<a id="â€”â†’-Halts&#39;"></a><a id="2710" href="stlc.norm.html#2710" class="Function">â€”â†’-Halts&#39;</a> <a id="2720" class="Symbol">:</a> <a id="2722" class="Symbol">âˆ€</a> <a id="2724" class="Symbol">{</a><a id="2725" href="stlc.norm.html#2725" class="Bound">M</a> <a id="2727" href="stlc.norm.html#2727" class="Bound">M&#39;</a> <a id="2730" class="Symbol">:</a> <a id="2732" href="stlc.base.html#932" class="Datatype">Term</a> <a id="2737" class="Number">0</a><a id="2738" class="Symbol">}</a> <a id="2740" class="Symbol">â†’</a> <a id="2742" href="stlc.norm.html#2725" class="Bound">M</a> <a id="2744" href="stlc.base.html#4875" class="Datatype Operator">â€”â†’</a> <a id="2747" href="stlc.norm.html#2727" class="Bound">M&#39;</a> <a id="2750" class="Symbol">â†’</a> <a id="2752" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="2758" href="stlc.norm.html#2727" class="Bound">M&#39;</a> <a id="2761" class="Symbol">â†’</a> <a id="2763" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="2769" href="stlc.norm.html#2725" class="Bound">M</a>
<a id="2771" href="stlc.norm.html#2710" class="Function">â€”â†’-Halts&#39;</a> <a id="2781" href="stlc.norm.html#2781" class="Bound">Mâ€”â†’M&#39;</a> <a id="2787" class="Symbol">(</a><a id="2788" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2794" class="Symbol">(_</a> <a id="2797" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="2798" class="Symbol">)</a> <a id="2800" href="stlc.norm.html#2800" class="Bound">VN</a><a id="2802" class="Symbol">)</a>                 <a id="2820" class="Symbol">=</a> <a id="2822" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2828" class="Symbol">(</a><a id="2829" href="stlc.base.html#5746" class="InductiveConstructor">stepâ€”â†’</a> <a id="2836" class="Symbol">_</a> <a id="2838" class="Symbol">(_</a> <a id="2841" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="2842" class="Symbol">)</a> <a id="2844" href="stlc.norm.html#2781" class="Bound">Mâ€”â†’M&#39;</a><a id="2849" class="Symbol">)</a> <a id="2851" href="stlc.norm.html#2800" class="Bound">VN</a>
<a id="2854" href="stlc.norm.html#2710" class="Function">â€”â†’-Halts&#39;</a> <a id="2864" href="stlc.norm.html#2864" class="Bound">Mâ€”â†’M&#39;</a> <a id="2870" class="Symbol">(</a><a id="2871" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2877" class="Symbol">(_</a> <a id="2880" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2884" href="stlc.norm.html#2884" class="Bound">M&#39;â€”â†’M</a> <a id="2890" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="2892" href="stlc.norm.html#2892" class="Bound">Mâ€”â†’*N</a><a id="2897" class="Symbol">)</a> <a id="2899" href="stlc.norm.html#2899" class="Bound">VN</a><a id="2901" class="Symbol">)</a> <a id="2903" class="Symbol">=</a> <a id="2905" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="2911" class="Symbol">(_</a> <a id="2914" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2918" href="stlc.norm.html#2864" class="Bound">Mâ€”â†’M&#39;</a> <a id="2924" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="2926" class="Symbol">_</a> <a id="2928" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2932" href="stlc.norm.html#2884" class="Bound">M&#39;â€”â†’M</a> <a id="2938" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="2940" href="stlc.norm.html#2892" class="Bound">Mâ€”â†’*N</a><a id="2945" class="Symbol">)</a> <a id="2947" href="stlc.norm.html#2899" class="Bound">VN</a>
</pre>
<p>Small step preserves normalization:</p>
<pre class="Agda"><a id="â€”â†’-ğ’©"></a><a id="3000" href="stlc.norm.html#3000" class="Function">â€”â†’-ğ’©</a> <a id="3005" class="Symbol">:</a> <a id="3007" class="Symbol">âˆ€</a> <a id="3009" class="Symbol">{</a><a id="3010" href="stlc.norm.html#3010" class="Bound">M</a> <a id="3012" href="stlc.norm.html#3012" class="Bound">M&#39;</a> <a id="3015" href="stlc.norm.html#3015" class="Bound">A</a><a id="3016" class="Symbol">}</a> <a id="3018" class="Symbol">â†’</a> <a id="3020" href="stlc.norm.html#3010" class="Bound">M</a> <a id="3022" href="stlc.base.html#4875" class="Datatype Operator">â€”â†’</a> <a id="3025" href="stlc.norm.html#3012" class="Bound">M&#39;</a> <a id="3028" class="Symbol">â†’</a> <a id="3030" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3032" href="stlc.norm.html#3015" class="Bound">A</a> <a id="3034" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3036" href="stlc.norm.html#3010" class="Bound">M</a> <a id="3038" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="3040" class="Symbol">â†’</a> <a id="3042" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3044" href="stlc.norm.html#3015" class="Bound">A</a> <a id="3046" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3048" href="stlc.norm.html#3012" class="Bound">M&#39;</a> <a id="3051" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
<a id="3053" href="stlc.norm.html#3000" class="Function">â€”â†’-ğ’©</a> <a id="3058" class="Symbol">{</a><a id="3059" class="Argument">A</a> <a id="3061" class="Symbol">=</a> <a id="3063" href="stlc.base.html#616" class="InductiveConstructor">Bool</a><a id="3067" class="Symbol">}</a>  <a id="3070" href="stlc.norm.html#3070" class="Bound">Mâ€”â†’M&#39;</a> <a id="3076" class="Symbol">(</a><a id="3077" href="stlc.norm.html#3077" class="Bound">âŠ¢M</a> <a id="3080" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3082" href="stlc.norm.html#3082" class="Bound">HM</a><a id="3084" class="Symbol">)</a>     <a id="3090" class="Symbol">=</a> <a id="3092" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3105" href="stlc.norm.html#3077" class="Bound">âŠ¢M</a> <a id="3108" href="stlc.norm.html#3070" class="Bound">Mâ€”â†’M&#39;</a> <a id="3114" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3116" href="stlc.norm.html#2471" class="Function">â€”â†’-Halts</a> <a id="3125" href="stlc.norm.html#3070" class="Bound">Mâ€”â†’M&#39;</a> <a id="3131" href="stlc.norm.html#3082" class="Bound">HM</a>
<a id="3134" href="stlc.norm.html#3000" class="Function">â€”â†’-ğ’©</a> <a id="3139" class="Symbol">{</a><a id="3140" class="Argument">A</a> <a id="3142" class="Symbol">=</a> <a id="3144" href="stlc.norm.html#3144" class="Bound">A</a> <a id="3146" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="3148" href="stlc.norm.html#3148" class="Bound">B</a><a id="3149" class="Symbol">}</a> <a id="3151" href="stlc.norm.html#3151" class="Bound">Mâ€”â†’M&#39;</a> <a id="3157" class="Symbol">(</a><a id="3158" href="stlc.norm.html#3158" class="Bound">âŠ¢M</a> <a id="3161" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3163" href="stlc.norm.html#3163" class="Bound">HM</a> <a id="3166" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3168" href="stlc.norm.html#3168" class="Bound">k</a><a id="3169" class="Symbol">)</a> <a id="3171" class="Symbol">=</a> <a id="3173" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3186" href="stlc.norm.html#3158" class="Bound">âŠ¢M</a> <a id="3189" href="stlc.norm.html#3151" class="Bound">Mâ€”â†’M&#39;</a> <a id="3195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3197" href="stlc.norm.html#2471" class="Function">â€”â†’-Halts</a> <a id="3206" href="stlc.norm.html#3151" class="Bound">Mâ€”â†’M&#39;</a> <a id="3212" href="stlc.norm.html#3163" class="Bound">HM</a> <a id="3215" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3217" class="Symbol">Î»</a> <a id="3219" href="stlc.norm.html#3219" class="Bound">z</a> <a id="3221" class="Symbol">â†’</a> <a id="3223" href="stlc.norm.html#3000" class="Function">â€”â†’-ğ’©</a> <a id="3228" class="Symbol">(</a><a id="3229" href="stlc.base.html#4917" class="InductiveConstructor">Î¾-appâ‚</a> <a id="3236" href="stlc.norm.html#3151" class="Bound">Mâ€”â†’M&#39;</a><a id="3241" class="Symbol">)</a> <a id="3243" class="Symbol">(</a><a id="3244" href="stlc.norm.html#3168" class="Bound">k</a> <a id="3246" href="stlc.norm.html#3219" class="Bound">z</a><a id="3247" class="Symbol">)</a>

<a id="â€”â†’-ğ’©&#39;"></a><a id="3250" href="stlc.norm.html#3250" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3256" class="Symbol">:</a> <a id="3258" class="Symbol">âˆ€</a> <a id="3260" class="Symbol">{</a><a id="3261" href="stlc.norm.html#3261" class="Bound">M</a> <a id="3263" href="stlc.norm.html#3263" class="Bound">M&#39;</a> <a id="3266" href="stlc.norm.html#3266" class="Bound">A</a><a id="3267" class="Symbol">}</a> <a id="3269" class="Symbol">â†’</a> <a id="3271" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="3273" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="3275" href="stlc.norm.html#3261" class="Bound">M</a> <a id="3277" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="3279" href="stlc.norm.html#3266" class="Bound">A</a> <a id="3281" class="Symbol">â†’</a> <a id="3283" href="stlc.norm.html#3261" class="Bound">M</a> <a id="3285" href="stlc.base.html#4875" class="Datatype Operator">â€”â†’</a> <a id="3288" href="stlc.norm.html#3263" class="Bound">M&#39;</a> <a id="3291" class="Symbol">â†’</a> <a id="3293" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3295" href="stlc.norm.html#3266" class="Bound">A</a> <a id="3297" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3299" href="stlc.norm.html#3263" class="Bound">M&#39;</a> <a id="3302" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="3304" class="Symbol">â†’</a> <a id="3306" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3308" href="stlc.norm.html#3266" class="Bound">A</a> <a id="3310" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3312" href="stlc.norm.html#3261" class="Bound">M</a> <a id="3314" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
<a id="3316" href="stlc.norm.html#3250" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3322" class="Symbol">{</a><a id="3323" class="Argument">A</a> <a id="3325" class="Symbol">=</a> <a id="3327" href="stlc.base.html#616" class="InductiveConstructor">Bool</a><a id="3331" class="Symbol">}</a>  <a id="3334" href="stlc.norm.html#3334" class="Bound">âŠ¢M</a> <a id="3337" href="stlc.norm.html#3337" class="Bound">Mâ€”â†’M&#39;</a> <a id="3343" class="Symbol">(</a><a id="3344" href="stlc.norm.html#3344" class="Bound">âŠ¢M&#39;</a> <a id="3348" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3350" href="stlc.norm.html#3350" class="Bound">HM&#39;</a><a id="3353" class="Symbol">)</a>     <a id="3359" class="Symbol">=</a> <a id="3361" href="stlc.norm.html#3334" class="Bound">âŠ¢M</a> <a id="3364" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3366" href="stlc.norm.html#2710" class="Function">â€”â†’-Halts&#39;</a> <a id="3376" href="stlc.norm.html#3337" class="Bound">Mâ€”â†’M&#39;</a> <a id="3382" href="stlc.norm.html#3350" class="Bound">HM&#39;</a>
<a id="3386" href="stlc.norm.html#3250" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3392" class="Symbol">{</a><a id="3393" class="Argument">A</a> <a id="3395" class="Symbol">=</a> <a id="3397" href="stlc.norm.html#3397" class="Bound">A</a> <a id="3399" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="3401" href="stlc.norm.html#3401" class="Bound">B</a><a id="3402" class="Symbol">}</a> <a id="3404" href="stlc.norm.html#3404" class="Bound">âŠ¢M</a> <a id="3407" href="stlc.norm.html#3407" class="Bound">Mâ€”â†’M&#39;</a> <a id="3413" class="Symbol">(</a><a id="3414" href="stlc.norm.html#3414" class="Bound">âŠ¢M&#39;</a> <a id="3418" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3420" href="stlc.norm.html#3420" class="Bound">HM&#39;</a> <a id="3424" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3426" href="stlc.norm.html#3426" class="Bound">k</a><a id="3427" class="Symbol">)</a> <a id="3429" class="Symbol">=</a> <a id="3431" href="stlc.norm.html#3404" class="Bound">âŠ¢M</a> <a id="3434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3436" href="stlc.norm.html#2710" class="Function">â€”â†’-Halts&#39;</a> <a id="3446" href="stlc.norm.html#3407" class="Bound">Mâ€”â†’M&#39;</a> <a id="3452" href="stlc.norm.html#3420" class="Bound">HM&#39;</a> <a id="3456" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3458" class="Symbol">Î»</a> <a id="3460" href="stlc.norm.html#3460" class="Bound">z</a> <a id="3462" class="Symbol">â†’</a> <a id="3464" href="stlc.norm.html#3250" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3470" class="Symbol">(</a><a id="3471" href="stlc.base.html#4209" class="InductiveConstructor">âŠ¢app</a> <a id="3476" href="stlc.norm.html#3404" class="Bound">âŠ¢M</a> <a id="3479" class="Symbol">(</a><a id="3480" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="3484" href="stlc.norm.html#3460" class="Bound">z</a><a id="3485" class="Symbol">))</a> <a id="3488" class="Symbol">(</a><a id="3489" href="stlc.base.html#4917" class="InductiveConstructor">Î¾-appâ‚</a> <a id="3496" href="stlc.norm.html#3407" class="Bound">Mâ€”â†’M&#39;</a><a id="3501" class="Symbol">)</a> <a id="3503" class="Symbol">(</a><a id="3504" href="stlc.norm.html#3426" class="Bound">k</a> <a id="3506" href="stlc.norm.html#3460" class="Bound">z</a><a id="3507" class="Symbol">)</a>
</pre>
<p>Multi step preserves normalization:</p>
<pre class="Agda"><a id="â€”â†’*-ğ’©"></a><a id="3559" href="stlc.norm.html#3559" class="Function">â€”â†’*-ğ’©</a> <a id="3565" class="Symbol">:</a> <a id="3567" class="Symbol">âˆ€</a> <a id="3569" class="Symbol">{</a><a id="3570" href="stlc.norm.html#3570" class="Bound">M</a> <a id="3572" href="stlc.norm.html#3572" class="Bound">M&#39;</a> <a id="3575" href="stlc.norm.html#3575" class="Bound">A</a><a id="3576" class="Symbol">}</a> <a id="3578" class="Symbol">â†’</a> <a id="3580" href="stlc.norm.html#3570" class="Bound">M</a> <a id="3582" href="stlc.base.html#5634" class="Datatype Operator">â€”â†’*</a> <a id="3586" href="stlc.norm.html#3572" class="Bound">M&#39;</a> <a id="3589" class="Symbol">â†’</a> <a id="3591" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3593" href="stlc.norm.html#3575" class="Bound">A</a> <a id="3595" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3597" href="stlc.norm.html#3570" class="Bound">M</a> <a id="3599" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="3601" class="Symbol">â†’</a> <a id="3603" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3605" href="stlc.norm.html#3575" class="Bound">A</a> <a id="3607" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3609" href="stlc.norm.html#3572" class="Bound">M&#39;</a> <a id="3612" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
<a id="3614" href="stlc.norm.html#3559" class="Function">â€”â†’*-ğ’©</a> <a id="3620" class="Symbol">(_</a> <a id="3623" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="3624" class="Symbol">)</a>                  <a id="3643" href="stlc.norm.html#3643" class="Bound">nn</a> <a id="3646" class="Symbol">=</a> <a id="3648" href="stlc.norm.html#3643" class="Bound">nn</a>
<a id="3651" href="stlc.norm.html#3559" class="Function">â€”â†’*-ğ’©</a> <a id="3657" class="Symbol">(_</a> <a id="3660" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="3664" href="stlc.norm.html#3664" class="Bound">Mâ€”â†’M&#39;</a> <a id="3670" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="3672" href="stlc.norm.html#3672" class="Bound">M&#39;â€”â†’*N</a><a id="3678" class="Symbol">)</a> <a id="3680" href="stlc.norm.html#3680" class="Bound">nn</a> <a id="3683" class="Symbol">=</a> <a id="3685" href="stlc.norm.html#3559" class="Function">â€”â†’*-ğ’©</a> <a id="3691" href="stlc.norm.html#3672" class="Bound">M&#39;â€”â†’*N</a> <a id="3698" class="Symbol">(</a><a id="3699" href="stlc.norm.html#3000" class="Function">â€”â†’-ğ’©</a> <a id="3704" href="stlc.norm.html#3664" class="Bound">Mâ€”â†’M&#39;</a> <a id="3710" href="stlc.norm.html#3680" class="Bound">nn</a><a id="3712" class="Symbol">)</a>

<a id="â€”â†’*-ğ’©&#39;"></a><a id="3715" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3722" class="Symbol">:</a> <a id="3724" class="Symbol">âˆ€</a> <a id="3726" class="Symbol">{</a><a id="3727" href="stlc.norm.html#3727" class="Bound">M</a> <a id="3729" href="stlc.norm.html#3729" class="Bound">M&#39;</a> <a id="3732" href="stlc.norm.html#3732" class="Bound">A</a><a id="3733" class="Symbol">}</a> <a id="3735" class="Symbol">â†’</a> <a id="3737" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="3739" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="3741" href="stlc.norm.html#3727" class="Bound">M</a> <a id="3743" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="3745" href="stlc.norm.html#3732" class="Bound">A</a> <a id="3747" class="Symbol">â†’</a> <a id="3749" href="stlc.norm.html#3727" class="Bound">M</a> <a id="3751" href="stlc.base.html#5634" class="Datatype Operator">â€”â†’*</a> <a id="3755" href="stlc.norm.html#3729" class="Bound">M&#39;</a> <a id="3758" class="Symbol">â†’</a> <a id="3760" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3762" href="stlc.norm.html#3732" class="Bound">A</a> <a id="3764" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3766" href="stlc.norm.html#3729" class="Bound">M&#39;</a> <a id="3769" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="3771" class="Symbol">â†’</a> <a id="3773" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="3775" href="stlc.norm.html#3732" class="Bound">A</a> <a id="3777" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="3779" href="stlc.norm.html#3727" class="Bound">M</a> <a id="3781" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
<a id="3783" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3790" href="stlc.norm.html#3790" class="Bound">âŠ¢M</a> <a id="3793" class="Symbol">(_</a> <a id="3796" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="3797" class="Symbol">)</a>                  <a id="3816" href="stlc.norm.html#3816" class="Bound">nn</a> <a id="3819" class="Symbol">=</a> <a id="3821" href="stlc.norm.html#3816" class="Bound">nn</a>
<a id="3824" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3831" href="stlc.norm.html#3831" class="Bound">âŠ¢M</a> <a id="3834" class="Symbol">(_</a> <a id="3837" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="3841" href="stlc.norm.html#3841" class="Bound">Mâ€”â†’M&#39;</a> <a id="3847" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="3849" href="stlc.norm.html#3849" class="Bound">M&#39;â€”â†’*N</a><a id="3855" class="Symbol">)</a> <a id="3857" href="stlc.norm.html#3857" class="Bound">nn</a> <a id="3860" class="Symbol">=</a> <a id="3862" href="stlc.norm.html#3250" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3868" href="stlc.norm.html#3831" class="Bound">âŠ¢M</a> <a id="3871" href="stlc.norm.html#3841" class="Bound">Mâ€”â†’M&#39;</a> <a id="3877" class="Symbol">(</a><a id="3878" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3885" class="Symbol">(</a><a id="3886" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3899" href="stlc.norm.html#3831" class="Bound">âŠ¢M</a> <a id="3902" href="stlc.norm.html#3841" class="Bound">Mâ€”â†’M&#39;</a><a id="3907" class="Symbol">)</a> <a id="3909" href="stlc.norm.html#3849" class="Bound">M&#39;â€”â†’*N</a> <a id="3916" href="stlc.norm.html#3857" class="Bound">nn</a><a id="3918" class="Symbol">)</a>
</pre>
<h2>Adequacy</h2>
<p>Normalizing term halts. This is encoded in the logical relation predicate.</p>
<pre class="Agda"><a id="ğ’©-halts"></a><a id="4022" href="stlc.norm.html#4022" class="Function">ğ’©-halts</a> <a id="4030" class="Symbol">:</a> <a id="4032" class="Symbol">âˆ€</a> <a id="4034" class="Symbol">{</a><a id="4035" href="stlc.norm.html#4035" class="Bound">M</a> <a id="4037" href="stlc.norm.html#4037" class="Bound">A</a><a id="4038" class="Symbol">}</a> <a id="4040" class="Symbol">â†’</a> <a id="4042" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="4044" href="stlc.norm.html#4037" class="Bound">A</a> <a id="4046" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="4048" href="stlc.norm.html#4035" class="Bound">M</a> <a id="4050" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="4052" class="Symbol">â†’</a> <a id="4054" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="4060" href="stlc.norm.html#4035" class="Bound">M</a>
<a id="4062" href="stlc.norm.html#4022" class="Function">ğ’©-halts</a> <a id="4070" class="Symbol">{</a><a id="4071" class="Argument">A</a> <a id="4073" class="Symbol">=</a> <a id="4075" href="stlc.base.html#616" class="InductiveConstructor">Bool</a><a id="4079" class="Symbol">}</a>  <a id="4082" class="Symbol">(</a><a id="4083" href="stlc.norm.html#4083" class="Bound">âŠ¢M</a> <a id="4086" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4088" href="stlc.norm.html#4088" class="Bound">HM</a><a id="4090" class="Symbol">)</a>     <a id="4096" class="Symbol">=</a> <a id="4098" href="stlc.norm.html#4088" class="Bound">HM</a>
<a id="4101" href="stlc.norm.html#4022" class="Function">ğ’©-halts</a> <a id="4109" class="Symbol">{</a><a id="4110" class="Argument">A</a> <a id="4112" class="Symbol">=</a> <a id="4114" href="stlc.norm.html#4114" class="Bound">A</a> <a id="4116" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="4118" href="stlc.norm.html#4118" class="Bound">B</a><a id="4119" class="Symbol">}</a> <a id="4121" class="Symbol">(</a><a id="4122" href="stlc.norm.html#4122" class="Bound">âŠ¢M</a> <a id="4125" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4127" href="stlc.norm.html#4127" class="Bound">HM</a> <a id="4130" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4132" href="stlc.norm.html#4132" class="Bound">k</a><a id="4133" class="Symbol">)</a> <a id="4135" class="Symbol">=</a> <a id="4137" href="stlc.norm.html#4127" class="Bound">HM</a>
</pre>
<h2>Fundamental Property</h2>
<p>Well typed term is normalizing:</p>
<pre class="Agda"><a id="âŠ¢ğ’©"></a><a id="4211" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="4214" class="Symbol">:</a> <a id="4216" class="Symbol">âˆ€</a> <a id="4218" class="Symbol">{</a><a id="4219" href="stlc.norm.html#4219" class="Bound">n</a><a id="4220" class="Symbol">}</a> <a id="4222" class="Symbol">{</a><a id="4223" href="stlc.norm.html#4223" class="Bound">Î“</a> <a id="4225" class="Symbol">:</a> <a id="4227" href="stlc.base.html#1948" class="Datatype">Context</a> <a id="4235" href="stlc.norm.html#4219" class="Bound">n</a><a id="4236" class="Symbol">}</a> <a id="4238" class="Symbol">{</a><a id="4239" href="stlc.norm.html#4239" class="Bound">Ïƒ</a> <a id="4241" class="Symbol">:</a> <a id="4243" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a> <a id="4247" href="stlc.norm.html#4219" class="Bound">n</a> <a id="4249" class="Symbol">â†’</a> <a id="4251" href="stlc.base.html#932" class="Datatype">Term</a> <a id="4256" class="Number">0</a><a id="4257" class="Symbol">}</a> <a id="4259" class="Symbol">{</a><a id="4260" href="stlc.norm.html#4260" class="Bound">M</a> <a id="4262" href="stlc.norm.html#4262" class="Bound">A</a><a id="4263" class="Symbol">}</a>
  <a id="4267" class="Symbol">â†’</a> <a id="4269" href="stlc.norm.html#4223" class="Bound">Î“</a> <a id="4271" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="4273" href="stlc.norm.html#4260" class="Bound">M</a> <a id="4275" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="4277" href="stlc.norm.html#4262" class="Bound">A</a> <a id="4279" class="Symbol">â†’</a> <a id="4281" href="stlc.norm.html#4239" class="Bound">Ïƒ</a> <a id="4283" href="stlc.norm.html#1596" class="Function Operator">âŠ¨</a> <a id="4285" href="stlc.norm.html#4223" class="Bound">Î“</a>
    <a id="4291" class="Comment">------------------</a>
  <a id="4312" class="Symbol">â†’</a> <a id="4314" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="4316" href="stlc.norm.html#4262" class="Bound">A</a> <a id="4318" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="4320" href="stlc.base.html#3341" class="Function">subst</a> <a id="4326" href="stlc.norm.html#4239" class="Bound">Ïƒ</a> <a id="4328" href="stlc.norm.html#4260" class="Bound">M</a> <a id="4330" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
</pre>
<ul>
<li>Case for variable, this is encoded in the definition.</li>
</ul>
<pre class="Agda"><a id="4402" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="4405" class="Symbol">(</a><a id="4406" href="stlc.base.html#4048" class="InductiveConstructor">âŠ¢var</a> <a id="4411" href="stlc.norm.html#4411" class="Bound">x</a><a id="4412" class="Symbol">)</a> <a id="4414" href="stlc.norm.html#4414" class="Bound">ÏƒâŠ¨Î“</a> <a id="4418" class="Symbol">=</a> <a id="4420" href="stlc.norm.html#4414" class="Bound">ÏƒâŠ¨Î“</a> <a id="4424" href="stlc.norm.html#4411" class="Bound">x</a>
</pre>
<ul>
<li>Case for lambda abstraction, we need to show that the term after substitution is also normalizing.</li>
</ul>
<pre class="Agda"><a id="4541" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="4544" class="Symbol">{</a><a id="4545" class="Argument">Ïƒ</a> <a id="4547" class="Symbol">=</a> <a id="4549" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="4550" class="Symbol">}</a> <a id="4552" class="Symbol">{</a><a id="4553" class="Argument">M</a> <a id="4555" class="Symbol">=</a> <a id="4557" href="stlc.base.html#1015" class="InductiveConstructor Operator">Æ›</a> <a id="4559" href="stlc.norm.html#4559" class="Bound">M</a><a id="4560" class="Symbol">}</a> <a id="4562" class="Symbol">{</a><a id="4563" class="Argument">A</a> <a id="4565" class="Symbol">=</a> <a id="4567" href="stlc.norm.html#4567" class="Bound">A</a> <a id="4569" href="stlc.base.html#630" class="InductiveConstructor Operator">â‡’</a> <a id="4571" href="stlc.norm.html#4571" class="Bound">B</a><a id="4572" class="Symbol">}</a> <a id="4574" class="Symbol">(</a><a id="4575" href="stlc.base.html#4121" class="InductiveConstructor">âŠ¢abs</a> <a id="4580" href="stlc.norm.html#4580" class="Bound">âŠ¢M</a><a id="4582" class="Symbol">)</a> <a id="4584" href="stlc.norm.html#4584" class="Bound">ÏƒâŠ¨Î“</a> <a id="4588" class="Symbol">=</a> <a id="4590" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="4597" class="Symbol">(</a><a id="4598" href="stlc.base.html#4121" class="InductiveConstructor">âŠ¢abs</a> <a id="4603" href="stlc.norm.html#4580" class="Bound">âŠ¢M</a><a id="4605" class="Symbol">)</a> <a id="4607" href="stlc.norm.html#4584" class="Bound">ÏƒâŠ¨Î“</a> <a id="4611" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4613" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="4619" class="Symbol">(</a><a id="4620" href="stlc.base.html#3341" class="Function">subst</a> <a id="4626" href="stlc.norm.html#4549" class="Bound">Ïƒ</a> <a id="4628" class="Symbol">(</a><a id="4629" href="stlc.base.html#1015" class="InductiveConstructor Operator">Æ›</a> <a id="4631" href="stlc.norm.html#4559" class="Bound">M</a><a id="4632" class="Symbol">)</a> <a id="4634" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="4635" class="Symbol">)</a> <a id="4637" href="stlc.base.html#4738" class="InductiveConstructor">V-abs</a> <a id="4643" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4645" href="stlc.norm.html#4659" class="Function">H</a>
  <a id="4649" class="Keyword">where</a>
    <a id="4659" href="stlc.norm.html#4659" class="Function">H</a> <a id="4661" class="Symbol">:</a> <a id="4663" class="Symbol">âˆ€</a> <a id="4665" class="Symbol">{</a><a id="4666" href="stlc.norm.html#4666" class="Bound">N</a><a id="4667" class="Symbol">}</a> <a id="4669" class="Symbol">â†’</a> <a id="4671" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="4673" href="stlc.norm.html#4567" class="Bound">A</a> <a id="4675" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="4677" href="stlc.norm.html#4666" class="Bound">N</a> <a id="4679" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a> <a id="4681" class="Symbol">â†’</a> <a id="4683" href="stlc.norm.html#1401" class="Function Operator">ğ’©</a> <a id="4685" href="stlc.norm.html#4571" class="Bound">B</a> <a id="4687" href="stlc.norm.html#1401" class="Function Operator">âŸ¦</a> <a id="4689" class="Symbol">(</a><a id="4690" href="stlc.base.html#1015" class="InductiveConstructor Operator">Æ›</a> <a id="4692" href="stlc.base.html#3341" class="Function">subst</a> <a id="4698" class="Symbol">(</a><a id="4699" href="stlc.base.html#3219" class="Function">exts</a> <a id="4704" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="4705" class="Symbol">)</a> <a id="4707" href="stlc.norm.html#4559" class="Bound">M</a><a id="4708" class="Symbol">)</a> <a id="4710" href="stlc.base.html#1081" class="InductiveConstructor Operator">Â·</a> <a id="4712" href="stlc.norm.html#4666" class="Bound">N</a> <a id="4714" href="stlc.norm.html#1401" class="Function Operator">âŸ§</a>
    <a id="4720" href="stlc.norm.html#4659" class="Function">H</a> <a id="4722" class="Symbol">{</a><a id="4723" href="stlc.norm.html#4723" class="Bound">N</a><a id="4724" class="Symbol">}</a> <a id="4726" href="stlc.norm.html#4726" class="Bound">nn</a> <a id="4729" class="Keyword">with</a> <a id="4734" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="4740" class="Symbol">{</a><a id="4741" class="Argument">N</a> <a id="4743" class="Symbol">=</a> <a id="4745" href="stlc.norm.html#4745" class="Bound">N&#39;</a><a id="4747" class="Symbol">}</a> <a id="4749" href="stlc.norm.html#4749" class="Bound">Nâ€”â†’*N&#39;</a> <a id="4756" href="stlc.norm.html#4756" class="Bound">VN&#39;</a> â† <a id="4762" href="stlc.norm.html#4022" class="Function">ğ’©-halts</a> <a id="4770" href="stlc.norm.html#4726" class="Bound">nn</a>
      <a id="4779" class="Symbol">=</a> <a id="4781" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="4788" class="Symbol">(</a><a id="4789" href="stlc.base.html#4209" class="InductiveConstructor">âŠ¢app</a> <a id="4794" class="Symbol">(</a><a id="4795" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="4802" class="Symbol">(</a><a id="4803" href="stlc.base.html#4121" class="InductiveConstructor">âŠ¢abs</a> <a id="4808" href="stlc.norm.html#4580" class="Bound">âŠ¢M</a><a id="4810" class="Symbol">)</a> <a id="4812" href="stlc.norm.html#4584" class="Bound">ÏƒâŠ¨Î“</a><a id="4815" class="Symbol">)</a> <a id="4817" class="Symbol">(</a><a id="4818" href="stlc.norm.html#1800" class="Function">ğ’©â†’âŠ¢</a> <a id="4822" href="stlc.norm.html#4726" class="Bound">nn</a><a id="4824" class="Symbol">))</a> <a id="4827" href="stlc.norm.html#4905" class="Function">lemma</a> <a id="4833" class="Symbol">(</a><a id="4834" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="4837" href="stlc.norm.html#4580" class="Bound">âŠ¢M</a> <a id="4840" class="Symbol">(Î»</a> <a id="4843" class="Symbol">{</a> <a id="4845" href="stlc.base.html#2232" class="InductiveConstructor">Z</a> <a id="4847" class="Symbol">â†’</a> <a id="4849" href="stlc.norm.html#3559" class="Function">â€”â†’*-ğ’©</a> <a id="4855" href="stlc.norm.html#4749" class="Bound">Nâ€”â†’*N&#39;</a> <a id="4862" href="stlc.norm.html#4726" class="Bound">nn</a> <a id="4865" class="Symbol">;</a> <a id="4867" class="Symbol">(</a><a id="4868" href="stlc.base.html#2312" class="InductiveConstructor">S</a> <a id="4870" href="stlc.norm.html#4870" class="Bound">x</a><a id="4871" class="Symbol">)</a> <a id="4873" class="Symbol">â†’</a> <a id="4875" href="stlc.norm.html#4584" class="Bound">ÏƒâŠ¨Î“</a> <a id="4879" href="stlc.norm.html#4870" class="Bound">x</a> <a id="4881" class="Symbol">}))</a>
      <a id="4891" class="Keyword">where</a>
        <a id="4905" href="stlc.norm.html#4905" class="Function">lemma</a> <a id="4911" class="Symbol">:</a> <a id="4913" class="Symbol">(</a><a id="4914" href="stlc.base.html#1015" class="InductiveConstructor Operator">Æ›</a> <a id="4916" href="stlc.base.html#3341" class="Function">subst</a> <a id="4922" class="Symbol">(</a><a id="4923" href="stlc.base.html#3219" class="Function">exts</a> <a id="4928" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="4929" class="Symbol">)</a> <a id="4931" href="stlc.norm.html#4559" class="Bound">M</a><a id="4932" class="Symbol">)</a> <a id="4934" href="stlc.base.html#1081" class="InductiveConstructor Operator">Â·</a> <a id="4936" href="stlc.norm.html#4723" class="Bound">N</a> <a id="4938" href="stlc.base.html#5634" class="Datatype Operator">â€”â†’*</a> <a id="4942" href="stlc.base.html#3341" class="Function">subst</a> <a id="4948" class="Symbol">(</a><a id="4949" href="stlc.norm.html#4745" class="Bound">N&#39;</a> <a id="4952" href="stlc.subst.html#1324" class="Function Operator">â€¢</a> <a id="4954" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="4955" class="Symbol">)</a> <a id="4957" href="stlc.norm.html#4559" class="Bound">M</a>
        <a id="4967" href="stlc.norm.html#4905" class="Function">lemma</a> <a id="4973" class="Keyword">rewrite</a> <a id="4981" href="stlc.subst.html#15017" class="Function">sub-ext-sub</a> <a id="4993" class="Symbol">{</a><a id="4994" class="Argument">Ïƒ</a> <a id="4996" class="Symbol">=</a> <a id="4998" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="4999" class="Symbol">}</a> <a id="5001" class="Symbol">{</a><a id="5002" class="Argument">M</a> <a id="5004" class="Symbol">=</a> <a id="5006" href="stlc.norm.html#4559" class="Bound">M</a><a id="5007" class="Symbol">}</a> <a id="5009" class="Symbol">{</a><a id="5010" class="Argument">N</a> <a id="5012" class="Symbol">=</a> <a id="5014" href="stlc.norm.html#4745" class="Bound">N&#39;</a><a id="5016" class="Symbol">}</a>
          <a id="5028" class="Symbol">=</a> <a id="5030" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="5040" class="Symbol">(</a><a id="5041" href="stlc.prop.html#7067" class="Function">appR-cong</a> <a id="5051" href="stlc.norm.html#4749" class="Bound">Nâ€”â†’*N&#39;</a><a id="5057" class="Symbol">)</a> <a id="5059" class="Symbol">((</a><a id="5061" href="stlc.base.html#1015" class="InductiveConstructor Operator">Æ›</a> <a id="5063" href="stlc.base.html#3341" class="Function">subst</a> <a id="5069" class="Symbol">(</a><a id="5070" href="stlc.base.html#3219" class="Function">exts</a> <a id="5075" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="5076" class="Symbol">)</a> <a id="5078" href="stlc.norm.html#4559" class="Bound">M</a><a id="5079" class="Symbol">)</a> <a id="5081" href="stlc.base.html#1081" class="InductiveConstructor Operator">Â·</a> <a id="5083" href="stlc.norm.html#4745" class="Bound">N&#39;</a> <a id="5086" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="5090" href="stlc.base.html#5097" class="InductiveConstructor">Î²-abs</a> <a id="5096" href="stlc.norm.html#4756" class="Bound">VN&#39;</a> <a id="5100" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="5102" class="Symbol">(</a><a id="5103" href="stlc.base.html#3341" class="Function">subst</a> <a id="5109" class="Symbol">(</a><a id="5110" href="stlc.base.html#3219" class="Function">exts</a> <a id="5115" href="stlc.norm.html#4549" class="Bound">Ïƒ</a><a id="5116" class="Symbol">)</a> <a id="5118" href="stlc.norm.html#4559" class="Bound">M</a> <a id="5120" href="stlc.base.html#3807" class="Function Operator">[</a> <a id="5122" href="stlc.norm.html#4745" class="Bound">N&#39;</a> <a id="5125" href="stlc.base.html#3807" class="Function Operator">]</a><a id="5126" class="Symbol">)</a> <a id="5128" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="5129" class="Symbol">)</a>
</pre>
<ul>
<li>Case for application, normalization is encoded in the logical relation predicate.</li>
</ul>
<pre class="Agda"><a id="5229" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5232" class="Symbol">(</a><a id="5233" href="stlc.base.html#4209" class="InductiveConstructor">âŠ¢app</a> <a id="5238" href="stlc.norm.html#5238" class="Bound">âŠ¢M</a> <a id="5241" href="stlc.norm.html#5241" class="Bound">âŠ¢N</a><a id="5243" class="Symbol">)</a> <a id="5245" href="stlc.norm.html#5245" class="Bound">ÏƒâŠ¨Î“</a> <a id="5249" class="Keyword">with</a> <a id="5254" href="stlc.norm.html#5254" class="Bound">âŠ¢ÏƒM</a> <a id="5258" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5260" href="stlc.norm.html#5260" class="Bound">HÏƒM</a> <a id="5264" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5266" href="stlc.norm.html#5266" class="Bound">H</a> â† <a id="5270" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5273" href="stlc.norm.html#5238" class="Bound">âŠ¢M</a> <a id="5276" href="stlc.norm.html#5245" class="Bound">ÏƒâŠ¨Î“</a> <a id="5280" class="Symbol">=</a> <a id="5282" href="stlc.norm.html#5266" class="Bound">H</a> <a id="5284" class="Symbol">(</a><a id="5285" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5288" href="stlc.norm.html#5241" class="Bound">âŠ¢N</a> <a id="5291" href="stlc.norm.html#5245" class="Bound">ÏƒâŠ¨Î“</a><a id="5294" class="Symbol">)</a>
</pre>
<ul>
<li>Case for <code>true</code> and <code>false</code>.</li>
</ul>
<pre class="Agda"><a id="5341" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5344" class="Symbol">{</a><a id="5345" class="Argument">Ïƒ</a> <a id="5347" class="Symbol">=</a> <a id="5349" href="stlc.norm.html#5349" class="Bound">Ïƒ</a><a id="5350" class="Symbol">}</a> <a id="5352" href="stlc.base.html#4310" class="InductiveConstructor">âŠ¢true</a>  <a id="5359" href="stlc.norm.html#5359" class="Bound">ÏƒâŠ¨Î“</a> <a id="5363" class="Symbol">=</a> <a id="5365" href="stlc.base.html#4310" class="InductiveConstructor">âŠ¢true</a> <a id="5371" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5373" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="5379" class="Symbol">(</a><a id="5380" href="stlc.base.html#3341" class="Function">subst</a> <a id="5386" href="stlc.norm.html#5349" class="Bound">Ïƒ</a> <a id="5388" href="stlc.base.html#1149" class="InductiveConstructor">true</a> <a id="5393" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="5394" class="Symbol">)</a> <a id="5396" href="stlc.base.html#4770" class="InductiveConstructor">V-true</a>
<a id="5403" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5406" class="Symbol">{</a><a id="5407" class="Argument">Ïƒ</a> <a id="5409" class="Symbol">=</a> <a id="5411" href="stlc.norm.html#5411" class="Bound">Ïƒ</a><a id="5412" class="Symbol">}</a> <a id="5414" href="stlc.base.html#4372" class="InductiveConstructor">âŠ¢false</a> <a id="5421" href="stlc.norm.html#5421" class="Bound">ÏƒâŠ¨Î“</a> <a id="5425" class="Symbol">=</a> <a id="5427" href="stlc.base.html#4372" class="InductiveConstructor">âŠ¢false</a> <a id="5434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5436" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="5442" class="Symbol">(</a><a id="5443" href="stlc.base.html#3341" class="Function">subst</a> <a id="5449" href="stlc.norm.html#5411" class="Bound">Ïƒ</a> <a id="5451" href="stlc.base.html#1166" class="InductiveConstructor">false</a> <a id="5457" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="5458" class="Symbol">)</a> <a id="5460" href="stlc.base.html#4793" class="InductiveConstructor">V-false</a>
</pre>
<ul>
<li>Case for <code>if</code>, we know that the condition <code>L</code> is normalizing, so it will reduce to either <code>true</code> or <code>false</code>.
Then we can proceed with either branch.</li>
</ul>
<pre class="Agda"><a id="5633" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5636" class="Symbol">{</a><a id="5637" class="Argument">Ïƒ</a> <a id="5639" class="Symbol">=</a> <a id="5641" href="stlc.norm.html#5641" class="Bound">Ïƒ</a><a id="5642" class="Symbol">}</a> <a id="5644" class="Symbol">{</a><a id="5645" class="Argument">M</a> <a id="5647" class="Symbol">=</a> <a id="5649" href="stlc.base.html#1183" class="InductiveConstructor">if</a> <a id="5652" href="stlc.norm.html#5652" class="Bound">L</a> <a id="5654" href="stlc.norm.html#5654" class="Bound">M</a> <a id="5656" href="stlc.norm.html#5656" class="Bound">N</a><a id="5657" class="Symbol">}</a> <a id="5659" class="Symbol">{</a><a id="5660" class="Argument">A</a> <a id="5662" class="Symbol">=</a> <a id="5664" href="stlc.norm.html#5664" class="Bound">A</a><a id="5665" class="Symbol">}</a> <a id="5667" class="Symbol">(</a><a id="5668" href="stlc.base.html#4437" class="InductiveConstructor">âŠ¢if</a> <a id="5672" href="stlc.norm.html#5672" class="Bound">âŠ¢L</a> <a id="5675" href="stlc.norm.html#5675" class="Bound">âŠ¢M</a> <a id="5678" href="stlc.norm.html#5678" class="Bound">âŠ¢N</a><a id="5680" class="Symbol">)</a> <a id="5682" href="stlc.norm.html#5682" class="Bound">ÏƒâŠ¨Î“</a> <a id="5686" class="Keyword">with</a> <a id="5691" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5694" href="stlc.norm.html#5672" class="Bound">âŠ¢L</a> <a id="5697" href="stlc.norm.html#5682" class="Bound">ÏƒâŠ¨Î“</a>
<a id="5701" class="Symbol">...</a> <a id="5705" class="Symbol">|</a> <a id="5707" href="stlc.norm.html#5707" class="Bound">âŠ¢ÏƒL</a> <a id="5711" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5713" href="stlc.norm.html#1276" class="InductiveConstructor">halts</a> <a id="5719" class="Symbol">{</a><a id="5720" class="Argument">N</a> <a id="5722" class="Symbol">=</a> <a id="5724" href="stlc.norm.html#5724" class="Bound">L&#39;</a><a id="5726" class="Symbol">}</a> <a id="5728" href="stlc.norm.html#5728" class="Bound">Lâ€”â†’*L&#39;</a> <a id="5735" href="stlc.norm.html#5735" class="Bound">VL</a> 
    <a id="5743" class="Keyword">with</a> <a id="5748" href="stlc.prop.html#4542" class="Function">Canonical-Bool</a> <a id="5763" class="Symbol">(</a><a id="5764" href="stlc.prop.html#6198" class="Function">â€”â†’*-pres</a> <a id="5773" href="stlc.norm.html#5707" class="Bound">âŠ¢ÏƒL</a> <a id="5777" href="stlc.norm.html#5728" class="Bound">Lâ€”â†’*L&#39;</a><a id="5783" class="Symbol">)</a> <a id="5785" href="stlc.norm.html#5735" class="Bound">VL</a>
<a id="5788" class="Symbol">...</a> <a id="5792" class="Symbol">|</a> <a id="5794" href="Data.Sum.Base.html#675" class="InductiveConstructor">injâ‚</a> <a id="5799" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5804" class="Symbol">=</a> <a id="5806" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="5813" class="Symbol">(</a><a id="5814" href="stlc.base.html#4437" class="InductiveConstructor">âŠ¢if</a> <a id="5818" class="Bound">âŠ¢ÏƒL</a> <a id="5822" class="Symbol">(</a><a id="5823" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="5830" class="Bound">âŠ¢M</a> <a id="5833" class="Bound">ÏƒâŠ¨Î“</a><a id="5836" class="Symbol">)</a> <a id="5838" class="Symbol">(</a><a id="5839" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="5846" class="Bound">âŠ¢N</a> <a id="5849" class="Bound">ÏƒâŠ¨Î“</a><a id="5852" class="Symbol">))</a>
                         <a id="5880" class="Symbol">(</a><a id="5881" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="5891" class="Symbol">(</a><a id="5892" href="stlc.prop.html#7291" class="Function">if-cong</a> <a id="5900" class="Bound">Lâ€”â†’*L&#39;</a><a id="5906" class="Symbol">)</a> <a id="5908" class="Symbol">(</a><a id="5909" href="stlc.base.html#1183" class="InductiveConstructor">if</a> <a id="5912" href="stlc.base.html#1149" class="InductiveConstructor">true</a> <a id="5917" class="Symbol">(</a><a id="5918" href="stlc.base.html#3341" class="Function">subst</a> <a id="5924" class="Bound">Ïƒ</a> <a id="5926" class="Bound">M</a><a id="5927" class="Symbol">)</a> <a id="5929" class="Symbol">(</a><a id="5930" href="stlc.base.html#3341" class="Function">subst</a> <a id="5936" class="Bound">Ïƒ</a> <a id="5938" class="Bound">N</a><a id="5939" class="Symbol">)</a> <a id="5941" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="5945" href="stlc.base.html#5279" class="InductiveConstructor">Î²-ifâ‚</a> <a id="5951" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="5953" href="stlc.base.html#3341" class="Function">subst</a> <a id="5959" class="Bound">Ïƒ</a> <a id="5961" class="Bound">M</a> <a id="5963" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="5964" class="Symbol">))</a> 
                         <a id="5993" class="Symbol">(</a><a id="5994" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="5997" class="Bound">âŠ¢M</a> <a id="6000" class="Bound">ÏƒâŠ¨Î“</a><a id="6003" class="Symbol">)</a>
<a id="6005" class="Symbol">...</a> <a id="6009" class="Symbol">|</a> <a id="6011" href="Data.Sum.Base.html#700" class="InductiveConstructor">injâ‚‚</a> <a id="6016" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6021" class="Symbol">=</a> <a id="6023" href="stlc.norm.html#3715" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="6030" class="Symbol">(</a><a id="6031" href="stlc.base.html#4437" class="InductiveConstructor">âŠ¢if</a> <a id="6035" class="Bound">âŠ¢ÏƒL</a> <a id="6039" class="Symbol">(</a><a id="6040" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="6047" class="Bound">âŠ¢M</a> <a id="6050" class="Bound">ÏƒâŠ¨Î“</a><a id="6053" class="Symbol">)</a> <a id="6055" class="Symbol">(</a><a id="6056" href="stlc.norm.html#2252" class="Function">âŠ¢subst</a> <a id="6063" class="Bound">âŠ¢N</a> <a id="6066" class="Bound">ÏƒâŠ¨Î“</a><a id="6069" class="Symbol">))</a>
                         <a id="6097" class="Symbol">(</a><a id="6098" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="6108" class="Symbol">(</a><a id="6109" href="stlc.prop.html#7291" class="Function">if-cong</a> <a id="6117" class="Bound">Lâ€”â†’*L&#39;</a><a id="6123" class="Symbol">)</a> <a id="6125" class="Symbol">(</a><a id="6126" href="stlc.base.html#1183" class="InductiveConstructor">if</a> <a id="6129" href="stlc.base.html#1166" class="InductiveConstructor">false</a> <a id="6135" class="Symbol">(</a><a id="6136" href="stlc.base.html#3341" class="Function">subst</a> <a id="6142" class="Bound">Ïƒ</a> <a id="6144" class="Bound">M</a><a id="6145" class="Symbol">)</a> <a id="6147" class="Symbol">(</a><a id="6148" href="stlc.base.html#3341" class="Function">subst</a> <a id="6154" class="Bound">Ïƒ</a> <a id="6156" class="Bound">N</a><a id="6157" class="Symbol">)</a> <a id="6159" href="stlc.base.html#5851" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="6163" href="stlc.base.html#5345" class="InductiveConstructor">Î²-ifâ‚‚</a> <a id="6169" href="stlc.base.html#5851" class="InductiveConstructor Operator">âŸ©</a> <a id="6171" href="stlc.base.html#3341" class="Function">subst</a> <a id="6177" class="Bound">Ïƒ</a> <a id="6179" class="Bound">N</a> <a id="6181" href="stlc.base.html#5678" class="InductiveConstructor Operator">âˆ</a><a id="6182" class="Symbol">))</a> 
                         <a id="6211" class="Symbol">(</a><a id="6212" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="6215" class="Bound">âŠ¢N</a> <a id="6218" class="Bound">ÏƒâŠ¨Î“</a><a id="6221" class="Symbol">)</a>
</pre>
<h2>Normalization</h2>
<p>Well typed term halts.</p>
<pre class="Agda"><a id="norm"></a><a id="6278" href="stlc.norm.html#6278" class="Function">norm</a> <a id="6283" class="Symbol">:</a> <a id="6285" class="Symbol">âˆ€</a> <a id="6287" class="Symbol">{</a><a id="6288" href="stlc.norm.html#6288" class="Bound">M</a> <a id="6290" href="stlc.norm.html#6290" class="Bound">A</a><a id="6291" class="Symbol">}</a> <a id="6293" class="Symbol">â†’</a> <a id="6295" href="stlc.base.html#1974" class="InductiveConstructor">âˆ…</a> <a id="6297" href="stlc.base.html#3995" class="Datatype Operator">âŠ¢</a> <a id="6299" href="stlc.norm.html#6288" class="Bound">M</a> <a id="6301" href="stlc.base.html#3995" class="Datatype Operator">â¦‚</a> <a id="6303" href="stlc.norm.html#6290" class="Bound">A</a> <a id="6305" class="Symbol">â†’</a> <a id="6307" href="stlc.norm.html#1239" class="Datatype">Halts</a> <a id="6313" href="stlc.norm.html#6288" class="Bound">M</a>
<a id="6315" href="stlc.norm.html#6278" class="Function">norm</a> <a id="6320" class="Symbol">{</a><a id="6321" class="Argument">M</a> <a id="6323" class="Symbol">=</a> <a id="6325" href="stlc.norm.html#6325" class="Bound">M</a><a id="6326" class="Symbol">}</a> <a id="6328" href="stlc.norm.html#6328" class="Bound">âŠ¢M</a> <a id="6331" class="Keyword">with</a> <a id="6336" href="stlc.norm.html#4022" class="Function">ğ’©-halts</a> <a id="6344" class="Symbol">(</a><a id="6345" href="stlc.norm.html#4211" class="Function">âŠ¢ğ’©</a> <a id="6348" class="Symbol">{</a><a id="6349" class="Argument">Ïƒ</a> <a id="6351" class="Symbol">=</a> <a id="6353" href="stlc.subst.html#1244" class="Function">ids</a><a id="6356" class="Symbol">}</a> <a id="6358" href="stlc.norm.html#6328" class="Bound">âŠ¢M</a> <a id="6361" class="Symbol">(Î»</a> <a id="6364" class="Symbol">()))</a>
<a id="6369" class="Symbol">...</a> <a id="6373" class="Symbol">|</a> <a id="6375" href="stlc.norm.html#6375" class="Bound">HM</a> <a id="6378" class="Keyword">rewrite</a> <a id="6386" href="stlc.subst.html#7398" class="Function">sub-id</a> <a id="6393" class="Symbol">{</a><a id="6394" class="Argument">M</a> <a id="6396" class="Symbol">=</a> <a id="6398" class="Bound">M</a><a id="6399" class="Symbol">}</a> <a id="6401" class="Symbol">=</a> <a id="6403" href="stlc.norm.html#6375" class="Bound">HM</a>
</pre>
    </main>
  </div>
</body>

</html>
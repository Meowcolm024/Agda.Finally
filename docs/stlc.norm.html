<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Normalization</title>
  <link rel="stylesheet" href="./static/Agda.css">
  <link rel="stylesheet" href="./static/style.css">
</head>

<body>
  <div class="container">
    <nav class="sidebar">
      <a href="./">
        <h2>Agda, Finally...</h2>
      </a>
      <div class="section">
        <h3>STLC</h3>
        <ul>
          <li>
            <a href="stlc.base.html" class="">
              Basics
            </a>
          </li>
          <li>
            <a href="stlc.prop.html" class="">
              Properties
            </a>
          </li>
          <li>
            <a href="stlc.bigstep.html" class="">
              Bigstep
            </a>
          </li>
          <li>
            <a href="stlc.natural.html" class="">
              Natural Semantics
            </a>
          </li>
          <li>
            <a href="stlc.norm.html" class="active">
              Normalization
            </a>
          </li>
          <li>
            <a href="stlc.soundness.html" class="">
              Semantic Typing
            </a>
          </li>
          <li>
            <a href="stlc.strengthen.html" class="">
              Strengthening
            </a>
          </li>
          <li>
            <a href="stlc.subst.html" class="">
              Substitution
            </a>
          </li>
          <li>
            <a href="stlc.clos.html" class="">
              Closure
            </a>
          </li>
        </ul>
      </div>
      <div class="section">
        <h3>Extra</h3>
        <ul>
          <li>
            <a href="extra.unscoped.html" class="">
              Unscoped
            </a>
          </li>
          <li>
            <a href="extra.sigma.html" class="">
              Explicit Substitutions
            </a>
          </li>
          <li>
            <a href="extra.mu.html" class="">
              Recursive Types
            </a>
          </li>
          <li>
            <a href="extra.systemf.html" class="">
              System F
            </a>
          </li>
        </ul>
      </div>
      <div class="section">
        <h3>Misc</h3>
        <ul>
          <li>
            <a href="finally.html" class="">
              Test
            </a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/Meowcolm024/Agda.Finally">
        <h3>Github</h3>
      </a>
    </nav>

    <main class="content">
      <h1>Normalization</h1>
      <blockquote>
<p>This part mainly follows the note <a href="https://cs.au.dk/~birke/papers/AnIntroductionToLogicalRelations.pdf">An Introduction to Logical Relations</a></p>
<p>You may also want to checkout the lecture note <a href="https://www.cs.uoregon.edu/research/summerschool/summer23/_lectures/Logical_Relations_Notes.pdf">OPLSS 2023: Logical Relations</a></p>
<p>Or the chapter <a href="https://softwarefoundations.cis.upenn.edu/plf-current/Norm.html">Normalization of STLC</a> from Programming Language Foundations</p>
</blockquote>
<pre class="Agda"><a id="512" class="Keyword">module</a> <a id="519" href="stlc.norm.html" class="Module">stlc.norm</a> <a id="529" class="Keyword">where</a>
</pre>
<p>Here we consider the (weak) normalization for stlc. Please refer to the notes above for motivation and explanation :P.</p>
<h2>Imports</h2>
<pre class="Agda"><a id="680" class="Keyword">open</a> <a id="685" class="Keyword">import</a> <a id="692" href="stlc.base.html" class="Module">stlc.base</a>
<a id="702" class="Keyword">open</a> <a id="707" class="Keyword">import</a> <a id="714" href="stlc.prop.html" class="Module">stlc.prop</a>
<a id="724" class="Keyword">open</a> <a id="729" class="Keyword">import</a> <a id="736" href="stlc.subst.html" class="Module">stlc.subst</a>
<a id="747" class="Keyword">open</a> <a id="752" href="stlc.base.html#5540" class="Module">multistep</a>

<a id="763" class="Keyword">import</a> <a id="770" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="808" class="Symbol">as</a> <a id="811" class="Module">Eq</a>
<a id="814" class="Keyword">open</a> <a id="819" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="822" class="Keyword">using</a> <a id="828" class="Symbol">(</a><a id="829" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_â‰¡_</a><a id="832" class="Symbol">;</a> <a id="834" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="838" class="Symbol">)</a>
<a id="840" class="Keyword">open</a> <a id="845" class="Keyword">import</a> <a id="852" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="861" class="Keyword">using</a> <a id="867" class="Symbol">(</a><a id="868" href="Agda.Builtin.Nat.html#203" class="Datatype">â„•</a><a id="869" class="Symbol">;</a> <a id="871" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="875" class="Symbol">;</a> <a id="877" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="880" class="Symbol">)</a>
<a id="882" class="Keyword">open</a> <a id="887" class="Keyword">import</a> <a id="894" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="903" class="Keyword">using</a> <a id="909" class="Symbol">(</a><a id="910" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a><a id="913" class="Symbol">;</a> <a id="915" href="Data.Fin.Base.html#1154" class="InductiveConstructor">zero</a><a id="919" class="Symbol">;</a> <a id="921" href="Data.Fin.Base.html#1175" class="InductiveConstructor">suc</a><a id="924" class="Symbol">)</a>
<a id="926" class="Keyword">open</a> <a id="931" class="Keyword">import</a> <a id="938" href="Data.Product.html" class="Module">Data.Product</a> <a id="951" class="Keyword">using</a> <a id="957" class="Symbol">(</a><a id="958" href="Data.Product.Base.html#1618" class="Function Operator">_Ã—_</a><a id="961" class="Symbol">;</a> <a id="963" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="966" class="Symbol">;</a> <a id="968" href="Data.Product.Base.html#1371" class="Function">âˆƒ-syntax</a><a id="976" class="Symbol">;</a> <a id="978" href="Data.Product.Base.html#1244" class="Function">Î£-syntax</a><a id="986" class="Symbol">)</a>
<a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="1009" class="Keyword">using</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Data.Sum.Base.html#625" class="Datatype Operator">_âŠ_</a><a id="1019" class="Symbol">;</a> <a id="1021" href="Data.Sum.Base.html#675" class="InductiveConstructor">injâ‚</a><a id="1025" class="Symbol">;</a> <a id="1027" href="Data.Sum.Base.html#700" class="InductiveConstructor">injâ‚‚</a><a id="1031" class="Symbol">)</a>
<a id="1033" class="Keyword">open</a> <a id="1038" class="Keyword">import</a> <a id="1045" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1062" class="Keyword">using</a> <a id="1068" class="Symbol">(</a><a id="1069" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">Â¬_</a><a id="1071" class="Symbol">;</a> <a id="1073" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a><a id="1086" class="Symbol">)</a>
<a id="1088" class="Keyword">open</a> <a id="1093" class="Keyword">import</a> <a id="1100" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="1111" class="Keyword">using</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Data.Empty.html#914" class="Function">âŠ¥</a><a id="1119" class="Symbol">;</a> <a id="1121" href="Data.Empty.html#1069" class="Function">âŠ¥-elim</a><a id="1127" class="Symbol">)</a>
</pre>
<h2>Definitions</h2>
<p>A term halts if there exists a reduction sequence that reduces it to value.</p>
<pre class="Agda"><a id="1235" class="Keyword">data</a> <a id="Halts"></a><a id="1240" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="1246" class="Symbol">{</a><a id="1247" href="stlc.norm.html#1247" class="Bound">n</a><a id="1248" class="Symbol">}</a> <a id="1250" class="Symbol">(</a><a id="1251" href="stlc.norm.html#1251" class="Bound">M</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="stlc.base.html#930" class="Datatype">Term</a> <a id="1260" href="stlc.norm.html#1247" class="Bound">n</a><a id="1261" class="Symbol">)</a> <a id="1263" class="Symbol">:</a> <a id="1265" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1269" class="Keyword">where</a>
  <a id="Halts.halts"></a><a id="1277" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="1283" class="Symbol">:</a> <a id="1285" class="Symbol">âˆ€</a> <a id="1287" class="Symbol">{</a><a id="1288" href="stlc.norm.html#1288" class="Bound">N</a><a id="1289" class="Symbol">}</a>
    <a id="1295" class="Symbol">â†’</a> <a id="1297" href="stlc.norm.html#1251" class="Bound">M</a> <a id="1299" href="stlc.base.html#5632" class="Datatype Operator">â€”â†’*</a> <a id="1303" href="stlc.norm.html#1288" class="Bound">N</a>
    <a id="1309" class="Symbol">â†’</a> <a id="1311" href="stlc.base.html#4703" class="Datatype">Value</a> <a id="1317" href="stlc.norm.html#1288" class="Bound">N</a>
      <a id="1325" class="Comment">--------</a>
    <a id="1338" class="Symbol">â†’</a> <a id="1340" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="1346" href="stlc.norm.html#1251" class="Bound">M</a>
</pre>
<p>The logical relation for normalization:</p>
<pre class="Agda"><a id="ğ’©_âŸ¦_âŸ§"></a><a id="1402" href="stlc.norm.html#1402" class="Function Operator">ğ’©_âŸ¦_âŸ§</a> <a id="1408" class="Symbol">:</a> <a id="1410" href="stlc.base.html#595" class="Datatype">Type</a> <a id="1415" class="Symbol">â†’</a> <a id="1417" href="stlc.base.html#930" class="Datatype">Term</a> <a id="1422" class="Number">0</a> <a id="1424" class="Symbol">â†’</a> <a id="1426" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1430" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1432" href="stlc.base.html#614" class="InductiveConstructor">Bool</a>  <a id="1438" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1440" href="stlc.norm.html#1440" class="Bound">M</a> <a id="1442" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="1444" class="Symbol">=</a> <a id="1446" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="1448" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="1450" href="stlc.norm.html#1440" class="Bound">M</a> <a id="1452" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="1454" href="stlc.base.html#614" class="InductiveConstructor">Bool</a>  <a id="1460" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1462" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="1468" href="stlc.norm.html#1440" class="Bound">M</a>
<a id="1470" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1472" href="stlc.norm.html#1472" class="Bound">A</a> <a id="1474" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="1476" href="stlc.norm.html#1476" class="Bound">B</a> <a id="1478" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1480" href="stlc.norm.html#1480" class="Bound">M</a> <a id="1482" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="1484" class="Symbol">=</a> <a id="1486" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="1488" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="1490" href="stlc.norm.html#1480" class="Bound">M</a> <a id="1492" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="1494" href="stlc.norm.html#1472" class="Bound">A</a> <a id="1496" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="1498" href="stlc.norm.html#1476" class="Bound">B</a> <a id="1500" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1502" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="1508" href="stlc.norm.html#1480" class="Bound">M</a> <a id="1510" href="Data.Product.Base.html#1618" class="Function Operator">Ã—</a> <a id="1512" class="Symbol">(âˆ€</a> <a id="1515" class="Symbol">{</a><a id="1516" href="stlc.norm.html#1516" class="Bound">N</a><a id="1517" class="Symbol">}</a> <a id="1519" class="Symbol">â†’</a> <a id="1521" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1523" href="stlc.norm.html#1472" class="Bound">A</a> <a id="1525" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1527" href="stlc.norm.html#1516" class="Bound">N</a> <a id="1529" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="1531" class="Symbol">â†’</a> <a id="1533" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1535" href="stlc.norm.html#1476" class="Bound">B</a> <a id="1537" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1539" href="stlc.norm.html#1480" class="Bound">M</a> <a id="1541" href="stlc.base.html#1079" class="InductiveConstructor Operator">Â·</a> <a id="1543" href="stlc.norm.html#1516" class="Bound">N</a> <a id="1545" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a><a id="1546" class="Symbol">)</a>
</pre>
<p>Substitution of normalizing terms:</p>
<pre class="Agda"><a id="_âŠ¨_"></a><a id="1597" href="stlc.norm.html#1597" class="Function Operator">_âŠ¨_</a> <a id="1601" class="Symbol">:</a> <a id="1603" class="Symbol">âˆ€</a> <a id="1605" class="Symbol">{</a><a id="1606" href="stlc.norm.html#1606" class="Bound">n</a><a id="1607" class="Symbol">}</a> <a id="1609" class="Symbol">â†’</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a> <a id="1616" href="stlc.norm.html#1606" class="Bound">n</a> <a id="1618" class="Symbol">â†’</a> <a id="1620" href="stlc.base.html#930" class="Datatype">Term</a> <a id="1625" class="Number">0</a><a id="1626" class="Symbol">)</a> <a id="1628" class="Symbol">â†’</a> <a id="1630" href="stlc.base.html#1946" class="Datatype">Context</a> <a id="1638" href="stlc.norm.html#1606" class="Bound">n</a> <a id="1640" class="Symbol">â†’</a> <a id="1642" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1646" href="stlc.norm.html#1646" class="Bound">Ïƒ</a> <a id="1648" href="stlc.norm.html#1597" class="Function Operator">âŠ¨</a> <a id="1650" href="stlc.norm.html#1650" class="Bound">Î“</a> <a id="1652" class="Symbol">=</a> <a id="1654" class="Symbol">âˆ€</a> <a id="1656" class="Symbol">{</a><a id="1657" href="stlc.norm.html#1657" class="Bound">x</a> <a id="1659" href="stlc.norm.html#1659" class="Bound">B</a><a id="1660" class="Symbol">}</a> <a id="1662" class="Symbol">â†’</a> <a id="1664" href="stlc.norm.html#1650" class="Bound">Î“</a> <a id="1666" href="stlc.base.html#2174" class="Datatype Operator">âˆ‹</a> <a id="1668" href="stlc.norm.html#1657" class="Bound">x</a> <a id="1670" href="stlc.base.html#2174" class="Datatype Operator">â¦‚</a> <a id="1672" href="stlc.norm.html#1659" class="Bound">B</a> <a id="1674" class="Symbol">â†’</a> <a id="1676" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1678" href="stlc.norm.html#1659" class="Bound">B</a> <a id="1680" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1682" href="stlc.norm.html#1646" class="Bound">Ïƒ</a> <a id="1684" href="stlc.norm.html#1657" class="Bound">x</a> <a id="1686" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
</pre>
<h2>Auxiliary Lemmas</h2>
<p>Normalizing terms are well typed (directly encoded in the logical predicate).</p>
<pre class="Agda"><a id="ğ’©â†’âŠ¢"></a><a id="1801" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="1805" class="Symbol">:</a> <a id="1807" class="Symbol">âˆ€</a> <a id="1809" class="Symbol">{</a><a id="1810" href="stlc.norm.html#1810" class="Bound">M</a> <a id="1812" href="stlc.norm.html#1812" class="Bound">A</a><a id="1813" class="Symbol">}</a> <a id="1815" class="Symbol">â†’</a> <a id="1817" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="1819" href="stlc.norm.html#1812" class="Bound">A</a> <a id="1821" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="1823" href="stlc.norm.html#1810" class="Bound">M</a> <a id="1825" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="1827" class="Symbol">â†’</a> <a id="1829" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="1831" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="1833" href="stlc.norm.html#1810" class="Bound">M</a> <a id="1835" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="1837" href="stlc.norm.html#1812" class="Bound">A</a>
<a id="1839" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="1843" class="Symbol">{</a><a id="1844" class="Argument">A</a> <a id="1846" class="Symbol">=</a> <a id="1848" href="stlc.base.html#614" class="InductiveConstructor">Bool</a><a id="1852" class="Symbol">}</a>  <a id="1855" class="Symbol">(</a><a id="1856" href="stlc.norm.html#1856" class="Bound">âŠ¢M</a> <a id="1859" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1861" class="Symbol">_)</a> <a id="1864" class="Symbol">=</a> <a id="1866" href="stlc.norm.html#1856" class="Bound">âŠ¢M</a>
<a id="1869" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="1873" class="Symbol">{</a><a id="1874" class="Argument">A</a> <a id="1876" class="Symbol">=</a> <a id="1878" href="stlc.norm.html#1878" class="Bound">A</a> <a id="1880" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="1882" href="stlc.norm.html#1882" class="Bound">B</a><a id="1883" class="Symbol">}</a> <a id="1885" class="Symbol">(</a><a id="1886" href="stlc.norm.html#1886" class="Bound">âŠ¢M</a> <a id="1889" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1891" class="Symbol">_)</a> <a id="1894" class="Symbol">=</a> <a id="1896" href="stlc.norm.html#1886" class="Bound">âŠ¢M</a>
</pre>
<p>The substitution that closes the term with normalizing term is well typed.</p>
<p>Note that, since we are using <em>parallel substitution</em>, there is no need to define
extra structures of simultaneous substitution for single substitution like in 
the normalization chapter of <a href="https://softwarefoundations.cis.upenn.edu/plf-current/Norm.html"><em>PLF</em></a>.</p>
<pre class="Agda"><a id="âŠ¢subst"></a><a id="2253" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="2260" class="Symbol">:</a> <a id="2262" class="Symbol">âˆ€</a> <a id="2264" class="Symbol">{</a><a id="2265" href="stlc.norm.html#2265" class="Bound">n</a><a id="2266" class="Symbol">}</a> <a id="2268" class="Symbol">{</a><a id="2269" href="stlc.norm.html#2269" class="Bound">Î“</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="stlc.base.html#1946" class="Datatype">Context</a> <a id="2281" href="stlc.norm.html#2265" class="Bound">n</a><a id="2282" class="Symbol">}</a> <a id="2284" class="Symbol">{</a><a id="2285" href="stlc.norm.html#2285" class="Bound">Ïƒ</a> <a id="2287" href="stlc.norm.html#2287" class="Bound">M</a> <a id="2289" href="stlc.norm.html#2289" class="Bound">A</a><a id="2290" class="Symbol">}</a>
  <a id="2294" class="Symbol">â†’</a> <a id="2296" href="stlc.norm.html#2269" class="Bound">Î“</a> <a id="2298" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="2300" href="stlc.norm.html#2287" class="Bound">M</a> <a id="2302" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="2304" href="stlc.norm.html#2289" class="Bound">A</a> <a id="2306" class="Symbol">â†’</a> <a id="2308" href="stlc.norm.html#2285" class="Bound">Ïƒ</a> <a id="2310" href="stlc.norm.html#1597" class="Function Operator">âŠ¨</a> <a id="2312" href="stlc.norm.html#2269" class="Bound">Î“</a>
    <a id="2318" class="Comment">------------------</a>
  <a id="2339" class="Symbol">â†’</a> <a id="2341" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="2343" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="2345" href="stlc.base.html#3339" class="Function">subst</a> <a id="2351" href="stlc.norm.html#2285" class="Bound">Ïƒ</a> <a id="2353" href="stlc.norm.html#2287" class="Bound">M</a> <a id="2355" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="2357" href="stlc.norm.html#2289" class="Bound">A</a>
<a id="2359" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="2366" href="stlc.norm.html#2366" class="Bound">âŠ¢M</a> <a id="2369" href="stlc.norm.html#2369" class="Bound">ÏƒâŠ¨Î“</a> <a id="2373" class="Symbol">=</a> <a id="2375" href="stlc.prop.html#2113" class="Function">ty-subst</a> <a id="2384" href="stlc.norm.html#2366" class="Bound">âŠ¢M</a> <a id="2387" class="Symbol">(Î»</a> <a id="2390" href="stlc.norm.html#2390" class="Bound">x</a> <a id="2392" class="Symbol">â†’</a> <a id="2394" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="2398" class="Symbol">(</a><a id="2399" href="stlc.norm.html#2369" class="Bound">ÏƒâŠ¨Î“</a> <a id="2403" href="stlc.norm.html#2390" class="Bound">x</a><a id="2404" class="Symbol">))</a>
</pre>
<p>Small step preserves halting (at both directions):</p>
<pre class="Agda"><a id="â€”â†’-Halts"></a><a id="2472" href="stlc.norm.html#2472" class="Function">â€”â†’-Halts</a> <a id="2481" class="Symbol">:</a> <a id="2483" class="Symbol">âˆ€</a> <a id="2485" class="Symbol">{</a><a id="2486" href="stlc.norm.html#2486" class="Bound">M</a> <a id="2488" href="stlc.norm.html#2488" class="Bound">M&#39;</a> <a id="2491" class="Symbol">:</a> <a id="2493" href="stlc.base.html#930" class="Datatype">Term</a> <a id="2498" class="Number">0</a><a id="2499" class="Symbol">}</a> <a id="2501" class="Symbol">â†’</a> <a id="2503" href="stlc.norm.html#2486" class="Bound">M</a> <a id="2505" href="stlc.base.html#4873" class="Datatype Operator">â€”â†’</a> <a id="2508" href="stlc.norm.html#2488" class="Bound">M&#39;</a> <a id="2511" class="Symbol">â†’</a> <a id="2513" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="2519" href="stlc.norm.html#2486" class="Bound">M</a> <a id="2521" class="Symbol">â†’</a> <a id="2523" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="2529" href="stlc.norm.html#2488" class="Bound">M&#39;</a>
<a id="2532" href="stlc.norm.html#2472" class="Function">â€”â†’-Halts</a> <a id="2541" href="stlc.norm.html#2541" class="Bound">Mâ€”â†’M&#39;</a> <a id="2547" class="Symbol">(</a><a id="2548" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2554" class="Symbol">(_</a> <a id="2557" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="2558" class="Symbol">)</a> <a id="2560" href="stlc.norm.html#2560" class="Bound">VN</a><a id="2562" class="Symbol">)</a>                    <a id="2583" class="Symbol">=</a> <a id="2585" href="Data.Empty.html#1069" class="Function">âŠ¥-elim</a> <a id="2592" class="Symbol">(</a><a id="2593" href="stlc.prop.html#5010" class="Function">V-Â¬â€”â†’</a> <a id="2599" href="stlc.norm.html#2560" class="Bound">VN</a> <a id="2602" href="stlc.norm.html#2541" class="Bound">Mâ€”â†’M&#39;</a><a id="2607" class="Symbol">)</a>
<a id="2609" href="stlc.norm.html#2472" class="Function">â€”â†’-Halts</a> <a id="2618" href="stlc.norm.html#2618" class="Bound">Mâ€”â†’M&#39;</a> <a id="2624" class="Symbol">(</a><a id="2625" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2631" class="Symbol">(_</a> <a id="2634" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2638" href="stlc.norm.html#2638" class="Bound">Mâ€”â†’M&#39;&#39;</a> <a id="2645" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="2647" href="stlc.norm.html#2647" class="Bound">M&#39;&#39;â€”â†’*N</a><a id="2654" class="Symbol">)</a> <a id="2656" href="stlc.norm.html#2656" class="Bound">VN</a><a id="2658" class="Symbol">)</a> <a id="2660" class="Keyword">rewrite</a> <a id="2668" href="stlc.prop.html#5186" class="Function">â€”â†’-determ</a> <a id="2678" href="stlc.norm.html#2618" class="Bound">Mâ€”â†’M&#39;</a> <a id="2684" href="stlc.norm.html#2638" class="Bound">Mâ€”â†’M&#39;&#39;</a> <a id="2691" class="Symbol">=</a> <a id="2693" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2699" href="stlc.norm.html#2647" class="Bound">M&#39;&#39;â€”â†’*N</a> <a id="2707" href="stlc.norm.html#2656" class="Bound">VN</a>

<a id="â€”â†’-Halts&#39;"></a><a id="2711" href="stlc.norm.html#2711" class="Function">â€”â†’-Halts&#39;</a> <a id="2721" class="Symbol">:</a> <a id="2723" class="Symbol">âˆ€</a> <a id="2725" class="Symbol">{</a><a id="2726" href="stlc.norm.html#2726" class="Bound">M</a> <a id="2728" href="stlc.norm.html#2728" class="Bound">M&#39;</a> <a id="2731" class="Symbol">:</a> <a id="2733" href="stlc.base.html#930" class="Datatype">Term</a> <a id="2738" class="Number">0</a><a id="2739" class="Symbol">}</a> <a id="2741" class="Symbol">â†’</a> <a id="2743" href="stlc.norm.html#2726" class="Bound">M</a> <a id="2745" href="stlc.base.html#4873" class="Datatype Operator">â€”â†’</a> <a id="2748" href="stlc.norm.html#2728" class="Bound">M&#39;</a> <a id="2751" class="Symbol">â†’</a> <a id="2753" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="2759" href="stlc.norm.html#2728" class="Bound">M&#39;</a> <a id="2762" class="Symbol">â†’</a> <a id="2764" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="2770" href="stlc.norm.html#2726" class="Bound">M</a>
<a id="2772" href="stlc.norm.html#2711" class="Function">â€”â†’-Halts&#39;</a> <a id="2782" href="stlc.norm.html#2782" class="Bound">Mâ€”â†’M&#39;</a> <a id="2788" class="Symbol">(</a><a id="2789" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2795" class="Symbol">(_</a> <a id="2798" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="2799" class="Symbol">)</a> <a id="2801" href="stlc.norm.html#2801" class="Bound">VN</a><a id="2803" class="Symbol">)</a>                 <a id="2821" class="Symbol">=</a> <a id="2823" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2829" class="Symbol">(</a><a id="2830" href="stlc.base.html#5744" class="InductiveConstructor">stepâ€”â†’</a> <a id="2837" class="Symbol">_</a> <a id="2839" class="Symbol">(_</a> <a id="2842" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="2843" class="Symbol">)</a> <a id="2845" href="stlc.norm.html#2782" class="Bound">Mâ€”â†’M&#39;</a><a id="2850" class="Symbol">)</a> <a id="2852" href="stlc.norm.html#2801" class="Bound">VN</a>
<a id="2855" href="stlc.norm.html#2711" class="Function">â€”â†’-Halts&#39;</a> <a id="2865" href="stlc.norm.html#2865" class="Bound">Mâ€”â†’M&#39;</a> <a id="2871" class="Symbol">(</a><a id="2872" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2878" class="Symbol">(_</a> <a id="2881" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2885" href="stlc.norm.html#2885" class="Bound">M&#39;â€”â†’M</a> <a id="2891" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="2893" href="stlc.norm.html#2893" class="Bound">Mâ€”â†’*N</a><a id="2898" class="Symbol">)</a> <a id="2900" href="stlc.norm.html#2900" class="Bound">VN</a><a id="2902" class="Symbol">)</a> <a id="2904" class="Symbol">=</a> <a id="2906" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="2912" class="Symbol">(_</a> <a id="2915" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2919" href="stlc.norm.html#2865" class="Bound">Mâ€”â†’M&#39;</a> <a id="2925" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="2927" class="Symbol">_</a> <a id="2929" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="2933" href="stlc.norm.html#2885" class="Bound">M&#39;â€”â†’M</a> <a id="2939" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="2941" href="stlc.norm.html#2893" class="Bound">Mâ€”â†’*N</a><a id="2946" class="Symbol">)</a> <a id="2948" href="stlc.norm.html#2900" class="Bound">VN</a>
</pre>
<p>Small step preserves normalization:</p>
<pre class="Agda"><a id="â€”â†’-ğ’©"></a><a id="3001" href="stlc.norm.html#3001" class="Function">â€”â†’-ğ’©</a> <a id="3006" class="Symbol">:</a> <a id="3008" class="Symbol">âˆ€</a> <a id="3010" class="Symbol">{</a><a id="3011" href="stlc.norm.html#3011" class="Bound">M</a> <a id="3013" href="stlc.norm.html#3013" class="Bound">M&#39;</a> <a id="3016" href="stlc.norm.html#3016" class="Bound">A</a><a id="3017" class="Symbol">}</a> <a id="3019" class="Symbol">â†’</a> <a id="3021" href="stlc.norm.html#3011" class="Bound">M</a> <a id="3023" href="stlc.base.html#4873" class="Datatype Operator">â€”â†’</a> <a id="3026" href="stlc.norm.html#3013" class="Bound">M&#39;</a> <a id="3029" class="Symbol">â†’</a> <a id="3031" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3033" href="stlc.norm.html#3016" class="Bound">A</a> <a id="3035" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3037" href="stlc.norm.html#3011" class="Bound">M</a> <a id="3039" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="3041" class="Symbol">â†’</a> <a id="3043" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3045" href="stlc.norm.html#3016" class="Bound">A</a> <a id="3047" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3049" href="stlc.norm.html#3013" class="Bound">M&#39;</a> <a id="3052" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
<a id="3054" href="stlc.norm.html#3001" class="Function">â€”â†’-ğ’©</a> <a id="3059" class="Symbol">{</a><a id="3060" class="Argument">A</a> <a id="3062" class="Symbol">=</a> <a id="3064" href="stlc.base.html#614" class="InductiveConstructor">Bool</a><a id="3068" class="Symbol">}</a>  <a id="3071" href="stlc.norm.html#3071" class="Bound">Mâ€”â†’M&#39;</a> <a id="3077" class="Symbol">(</a><a id="3078" href="stlc.norm.html#3078" class="Bound">âŠ¢M</a> <a id="3081" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3083" href="stlc.norm.html#3083" class="Bound">HM</a><a id="3085" class="Symbol">)</a>     <a id="3091" class="Symbol">=</a> <a id="3093" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3106" href="stlc.norm.html#3078" class="Bound">âŠ¢M</a> <a id="3109" href="stlc.norm.html#3071" class="Bound">Mâ€”â†’M&#39;</a> <a id="3115" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3117" href="stlc.norm.html#2472" class="Function">â€”â†’-Halts</a> <a id="3126" href="stlc.norm.html#3071" class="Bound">Mâ€”â†’M&#39;</a> <a id="3132" href="stlc.norm.html#3083" class="Bound">HM</a>
<a id="3135" href="stlc.norm.html#3001" class="Function">â€”â†’-ğ’©</a> <a id="3140" class="Symbol">{</a><a id="3141" class="Argument">A</a> <a id="3143" class="Symbol">=</a> <a id="3145" href="stlc.norm.html#3145" class="Bound">A</a> <a id="3147" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="3149" href="stlc.norm.html#3149" class="Bound">B</a><a id="3150" class="Symbol">}</a> <a id="3152" href="stlc.norm.html#3152" class="Bound">Mâ€”â†’M&#39;</a> <a id="3158" class="Symbol">(</a><a id="3159" href="stlc.norm.html#3159" class="Bound">âŠ¢M</a> <a id="3162" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3164" href="stlc.norm.html#3164" class="Bound">HM</a> <a id="3167" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3169" href="stlc.norm.html#3169" class="Bound">k</a><a id="3170" class="Symbol">)</a> <a id="3172" class="Symbol">=</a> <a id="3174" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3187" href="stlc.norm.html#3159" class="Bound">âŠ¢M</a> <a id="3190" href="stlc.norm.html#3152" class="Bound">Mâ€”â†’M&#39;</a> <a id="3196" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3198" href="stlc.norm.html#2472" class="Function">â€”â†’-Halts</a> <a id="3207" href="stlc.norm.html#3152" class="Bound">Mâ€”â†’M&#39;</a> <a id="3213" href="stlc.norm.html#3164" class="Bound">HM</a> <a id="3216" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3218" class="Symbol">Î»</a> <a id="3220" href="stlc.norm.html#3220" class="Bound">z</a> <a id="3222" class="Symbol">â†’</a> <a id="3224" href="stlc.norm.html#3001" class="Function">â€”â†’-ğ’©</a> <a id="3229" class="Symbol">(</a><a id="3230" href="stlc.base.html#4915" class="InductiveConstructor">Î¾-appâ‚</a> <a id="3237" href="stlc.norm.html#3152" class="Bound">Mâ€”â†’M&#39;</a><a id="3242" class="Symbol">)</a> <a id="3244" class="Symbol">(</a><a id="3245" href="stlc.norm.html#3169" class="Bound">k</a> <a id="3247" href="stlc.norm.html#3220" class="Bound">z</a><a id="3248" class="Symbol">)</a>

<a id="â€”â†’-ğ’©&#39;"></a><a id="3251" href="stlc.norm.html#3251" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3257" class="Symbol">:</a> <a id="3259" class="Symbol">âˆ€</a> <a id="3261" class="Symbol">{</a><a id="3262" href="stlc.norm.html#3262" class="Bound">M</a> <a id="3264" href="stlc.norm.html#3264" class="Bound">M&#39;</a> <a id="3267" href="stlc.norm.html#3267" class="Bound">A</a><a id="3268" class="Symbol">}</a> <a id="3270" class="Symbol">â†’</a> <a id="3272" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="3274" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="3276" href="stlc.norm.html#3262" class="Bound">M</a> <a id="3278" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="3280" href="stlc.norm.html#3267" class="Bound">A</a> <a id="3282" class="Symbol">â†’</a> <a id="3284" href="stlc.norm.html#3262" class="Bound">M</a> <a id="3286" href="stlc.base.html#4873" class="Datatype Operator">â€”â†’</a> <a id="3289" href="stlc.norm.html#3264" class="Bound">M&#39;</a> <a id="3292" class="Symbol">â†’</a> <a id="3294" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3296" href="stlc.norm.html#3267" class="Bound">A</a> <a id="3298" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3300" href="stlc.norm.html#3264" class="Bound">M&#39;</a> <a id="3303" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="3305" class="Symbol">â†’</a> <a id="3307" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3309" href="stlc.norm.html#3267" class="Bound">A</a> <a id="3311" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3313" href="stlc.norm.html#3262" class="Bound">M</a> <a id="3315" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
<a id="3317" href="stlc.norm.html#3251" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3323" class="Symbol">{</a><a id="3324" class="Argument">A</a> <a id="3326" class="Symbol">=</a> <a id="3328" href="stlc.base.html#614" class="InductiveConstructor">Bool</a><a id="3332" class="Symbol">}</a>  <a id="3335" href="stlc.norm.html#3335" class="Bound">âŠ¢M</a> <a id="3338" href="stlc.norm.html#3338" class="Bound">Mâ€”â†’M&#39;</a> <a id="3344" class="Symbol">(</a><a id="3345" href="stlc.norm.html#3345" class="Bound">âŠ¢M&#39;</a> <a id="3349" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3351" href="stlc.norm.html#3351" class="Bound">HM&#39;</a><a id="3354" class="Symbol">)</a>     <a id="3360" class="Symbol">=</a> <a id="3362" href="stlc.norm.html#3335" class="Bound">âŠ¢M</a> <a id="3365" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3367" href="stlc.norm.html#2711" class="Function">â€”â†’-Halts&#39;</a> <a id="3377" href="stlc.norm.html#3338" class="Bound">Mâ€”â†’M&#39;</a> <a id="3383" href="stlc.norm.html#3351" class="Bound">HM&#39;</a>
<a id="3387" href="stlc.norm.html#3251" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3393" class="Symbol">{</a><a id="3394" class="Argument">A</a> <a id="3396" class="Symbol">=</a> <a id="3398" href="stlc.norm.html#3398" class="Bound">A</a> <a id="3400" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="3402" href="stlc.norm.html#3402" class="Bound">B</a><a id="3403" class="Symbol">}</a> <a id="3405" href="stlc.norm.html#3405" class="Bound">âŠ¢M</a> <a id="3408" href="stlc.norm.html#3408" class="Bound">Mâ€”â†’M&#39;</a> <a id="3414" class="Symbol">(</a><a id="3415" href="stlc.norm.html#3415" class="Bound">âŠ¢M&#39;</a> <a id="3419" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3421" href="stlc.norm.html#3421" class="Bound">HM&#39;</a> <a id="3425" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3427" href="stlc.norm.html#3427" class="Bound">k</a><a id="3428" class="Symbol">)</a> <a id="3430" class="Symbol">=</a> <a id="3432" href="stlc.norm.html#3405" class="Bound">âŠ¢M</a> <a id="3435" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3437" href="stlc.norm.html#2711" class="Function">â€”â†’-Halts&#39;</a> <a id="3447" href="stlc.norm.html#3408" class="Bound">Mâ€”â†’M&#39;</a> <a id="3453" href="stlc.norm.html#3421" class="Bound">HM&#39;</a> <a id="3457" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3459" class="Symbol">Î»</a> <a id="3461" href="stlc.norm.html#3461" class="Bound">z</a> <a id="3463" class="Symbol">â†’</a> <a id="3465" href="stlc.norm.html#3251" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3471" class="Symbol">(</a><a id="3472" href="stlc.base.html#4207" class="InductiveConstructor">âŠ¢app</a> <a id="3477" href="stlc.norm.html#3405" class="Bound">âŠ¢M</a> <a id="3480" class="Symbol">(</a><a id="3481" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="3485" href="stlc.norm.html#3461" class="Bound">z</a><a id="3486" class="Symbol">))</a> <a id="3489" class="Symbol">(</a><a id="3490" href="stlc.base.html#4915" class="InductiveConstructor">Î¾-appâ‚</a> <a id="3497" href="stlc.norm.html#3408" class="Bound">Mâ€”â†’M&#39;</a><a id="3502" class="Symbol">)</a> <a id="3504" class="Symbol">(</a><a id="3505" href="stlc.norm.html#3427" class="Bound">k</a> <a id="3507" href="stlc.norm.html#3461" class="Bound">z</a><a id="3508" class="Symbol">)</a>
</pre>
<p>Multi step preserves normalization:</p>
<pre class="Agda"><a id="â€”â†’*-ğ’©"></a><a id="3560" href="stlc.norm.html#3560" class="Function">â€”â†’*-ğ’©</a> <a id="3566" class="Symbol">:</a> <a id="3568" class="Symbol">âˆ€</a> <a id="3570" class="Symbol">{</a><a id="3571" href="stlc.norm.html#3571" class="Bound">M</a> <a id="3573" href="stlc.norm.html#3573" class="Bound">M&#39;</a> <a id="3576" href="stlc.norm.html#3576" class="Bound">A</a><a id="3577" class="Symbol">}</a> <a id="3579" class="Symbol">â†’</a> <a id="3581" href="stlc.norm.html#3571" class="Bound">M</a> <a id="3583" href="stlc.base.html#5632" class="Datatype Operator">â€”â†’*</a> <a id="3587" href="stlc.norm.html#3573" class="Bound">M&#39;</a> <a id="3590" class="Symbol">â†’</a> <a id="3592" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3594" href="stlc.norm.html#3576" class="Bound">A</a> <a id="3596" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3598" href="stlc.norm.html#3571" class="Bound">M</a> <a id="3600" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="3602" class="Symbol">â†’</a> <a id="3604" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3606" href="stlc.norm.html#3576" class="Bound">A</a> <a id="3608" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3610" href="stlc.norm.html#3573" class="Bound">M&#39;</a> <a id="3613" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
<a id="3615" href="stlc.norm.html#3560" class="Function">â€”â†’*-ğ’©</a> <a id="3621" class="Symbol">(_</a> <a id="3624" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="3625" class="Symbol">)</a>                  <a id="3644" href="stlc.norm.html#3644" class="Bound">nn</a> <a id="3647" class="Symbol">=</a> <a id="3649" href="stlc.norm.html#3644" class="Bound">nn</a>
<a id="3652" href="stlc.norm.html#3560" class="Function">â€”â†’*-ğ’©</a> <a id="3658" class="Symbol">(_</a> <a id="3661" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="3665" href="stlc.norm.html#3665" class="Bound">Mâ€”â†’M&#39;</a> <a id="3671" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="3673" href="stlc.norm.html#3673" class="Bound">M&#39;â€”â†’*N</a><a id="3679" class="Symbol">)</a> <a id="3681" href="stlc.norm.html#3681" class="Bound">nn</a> <a id="3684" class="Symbol">=</a> <a id="3686" href="stlc.norm.html#3560" class="Function">â€”â†’*-ğ’©</a> <a id="3692" href="stlc.norm.html#3673" class="Bound">M&#39;â€”â†’*N</a> <a id="3699" class="Symbol">(</a><a id="3700" href="stlc.norm.html#3001" class="Function">â€”â†’-ğ’©</a> <a id="3705" href="stlc.norm.html#3665" class="Bound">Mâ€”â†’M&#39;</a> <a id="3711" href="stlc.norm.html#3681" class="Bound">nn</a><a id="3713" class="Symbol">)</a>

<a id="â€”â†’*-ğ’©&#39;"></a><a id="3716" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3723" class="Symbol">:</a> <a id="3725" class="Symbol">âˆ€</a> <a id="3727" class="Symbol">{</a><a id="3728" href="stlc.norm.html#3728" class="Bound">M</a> <a id="3730" href="stlc.norm.html#3730" class="Bound">M&#39;</a> <a id="3733" href="stlc.norm.html#3733" class="Bound">A</a><a id="3734" class="Symbol">}</a> <a id="3736" class="Symbol">â†’</a> <a id="3738" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="3740" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="3742" href="stlc.norm.html#3728" class="Bound">M</a> <a id="3744" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="3746" href="stlc.norm.html#3733" class="Bound">A</a> <a id="3748" class="Symbol">â†’</a> <a id="3750" href="stlc.norm.html#3728" class="Bound">M</a> <a id="3752" href="stlc.base.html#5632" class="Datatype Operator">â€”â†’*</a> <a id="3756" href="stlc.norm.html#3730" class="Bound">M&#39;</a> <a id="3759" class="Symbol">â†’</a> <a id="3761" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3763" href="stlc.norm.html#3733" class="Bound">A</a> <a id="3765" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3767" href="stlc.norm.html#3730" class="Bound">M&#39;</a> <a id="3770" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="3772" class="Symbol">â†’</a> <a id="3774" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="3776" href="stlc.norm.html#3733" class="Bound">A</a> <a id="3778" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="3780" href="stlc.norm.html#3728" class="Bound">M</a> <a id="3782" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
<a id="3784" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3791" href="stlc.norm.html#3791" class="Bound">âŠ¢M</a> <a id="3794" class="Symbol">(_</a> <a id="3797" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="3798" class="Symbol">)</a>                  <a id="3817" href="stlc.norm.html#3817" class="Bound">nn</a> <a id="3820" class="Symbol">=</a> <a id="3822" href="stlc.norm.html#3817" class="Bound">nn</a>
<a id="3825" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3832" href="stlc.norm.html#3832" class="Bound">âŠ¢M</a> <a id="3835" class="Symbol">(_</a> <a id="3838" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="3842" href="stlc.norm.html#3842" class="Bound">Mâ€”â†’M&#39;</a> <a id="3848" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="3850" href="stlc.norm.html#3850" class="Bound">M&#39;â€”â†’*N</a><a id="3856" class="Symbol">)</a> <a id="3858" href="stlc.norm.html#3858" class="Bound">nn</a> <a id="3861" class="Symbol">=</a> <a id="3863" href="stlc.norm.html#3251" class="Function">â€”â†’-ğ’©&#39;</a> <a id="3869" href="stlc.norm.html#3832" class="Bound">âŠ¢M</a> <a id="3872" href="stlc.norm.html#3842" class="Bound">Mâ€”â†’M&#39;</a> <a id="3878" class="Symbol">(</a><a id="3879" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="3886" class="Symbol">(</a><a id="3887" href="stlc.prop.html#2944" class="Function">preservation</a> <a id="3900" href="stlc.norm.html#3832" class="Bound">âŠ¢M</a> <a id="3903" href="stlc.norm.html#3842" class="Bound">Mâ€”â†’M&#39;</a><a id="3908" class="Symbol">)</a> <a id="3910" href="stlc.norm.html#3850" class="Bound">M&#39;â€”â†’*N</a> <a id="3917" href="stlc.norm.html#3858" class="Bound">nn</a><a id="3919" class="Symbol">)</a>
</pre>
<h2>Adequacy</h2>
<p>Normalizing term halts. This is encoded in the logical relation predicate.</p>
<pre class="Agda"><a id="ğ’©-halts"></a><a id="4023" href="stlc.norm.html#4023" class="Function">ğ’©-halts</a> <a id="4031" class="Symbol">:</a> <a id="4033" class="Symbol">âˆ€</a> <a id="4035" class="Symbol">{</a><a id="4036" href="stlc.norm.html#4036" class="Bound">M</a> <a id="4038" href="stlc.norm.html#4038" class="Bound">A</a><a id="4039" class="Symbol">}</a> <a id="4041" class="Symbol">â†’</a> <a id="4043" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="4045" href="stlc.norm.html#4038" class="Bound">A</a> <a id="4047" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="4049" href="stlc.norm.html#4036" class="Bound">M</a> <a id="4051" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="4053" class="Symbol">â†’</a> <a id="4055" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="4061" href="stlc.norm.html#4036" class="Bound">M</a>
<a id="4063" href="stlc.norm.html#4023" class="Function">ğ’©-halts</a> <a id="4071" class="Symbol">{</a><a id="4072" class="Argument">A</a> <a id="4074" class="Symbol">=</a> <a id="4076" href="stlc.base.html#614" class="InductiveConstructor">Bool</a><a id="4080" class="Symbol">}</a>  <a id="4083" class="Symbol">(</a><a id="4084" href="stlc.norm.html#4084" class="Bound">âŠ¢M</a> <a id="4087" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4089" href="stlc.norm.html#4089" class="Bound">HM</a><a id="4091" class="Symbol">)</a>        <a id="4100" class="Symbol">=</a> <a id="4102" href="stlc.norm.html#4089" class="Bound">HM</a>
<a id="4105" href="stlc.norm.html#4023" class="Function">ğ’©-halts</a> <a id="4113" class="Symbol">{</a><a id="4114" class="Argument">A</a> <a id="4116" class="Symbol">=</a> <a id="4118" href="stlc.norm.html#4118" class="Bound">A</a> <a id="4120" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="4122" href="stlc.norm.html#4122" class="Bound">B</a><a id="4123" class="Symbol">}</a> <a id="4125" class="Symbol">(</a><a id="4126" href="stlc.norm.html#4126" class="Bound">âŠ¢M</a> <a id="4129" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4131" href="stlc.norm.html#4131" class="Bound">nn&#39;</a> <a id="4135" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4137" href="stlc.norm.html#4137" class="Bound">HMN</a><a id="4140" class="Symbol">)</a> <a id="4142" class="Symbol">=</a> <a id="4144" href="stlc.norm.html#4131" class="Bound">nn&#39;</a>
</pre>
<h2>Fundamental Property</h2>
<p>Well typed term is normalizing:</p>
<pre class="Agda"><a id="âŠ¢ğ’©"></a><a id="4219" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="4222" class="Symbol">:</a> <a id="4224" class="Symbol">âˆ€</a> <a id="4226" class="Symbol">{</a><a id="4227" href="stlc.norm.html#4227" class="Bound">n</a><a id="4228" class="Symbol">}</a> <a id="4230" class="Symbol">{</a><a id="4231" href="stlc.norm.html#4231" class="Bound">Î“</a> <a id="4233" class="Symbol">:</a> <a id="4235" href="stlc.base.html#1946" class="Datatype">Context</a> <a id="4243" href="stlc.norm.html#4227" class="Bound">n</a><a id="4244" class="Symbol">}</a> <a id="4246" class="Symbol">{</a><a id="4247" href="stlc.norm.html#4247" class="Bound">Ïƒ</a> <a id="4249" class="Symbol">:</a> <a id="4251" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a> <a id="4255" href="stlc.norm.html#4227" class="Bound">n</a> <a id="4257" class="Symbol">â†’</a> <a id="4259" href="stlc.base.html#930" class="Datatype">Term</a> <a id="4264" class="Number">0</a><a id="4265" class="Symbol">}</a> <a id="4267" class="Symbol">{</a><a id="4268" href="stlc.norm.html#4268" class="Bound">M</a> <a id="4270" href="stlc.norm.html#4270" class="Bound">A</a><a id="4271" class="Symbol">}</a>
  <a id="4275" class="Symbol">â†’</a> <a id="4277" href="stlc.norm.html#4231" class="Bound">Î“</a> <a id="4279" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="4281" href="stlc.norm.html#4268" class="Bound">M</a> <a id="4283" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="4285" href="stlc.norm.html#4270" class="Bound">A</a> <a id="4287" class="Symbol">â†’</a> <a id="4289" href="stlc.norm.html#4247" class="Bound">Ïƒ</a> <a id="4291" href="stlc.norm.html#1597" class="Function Operator">âŠ¨</a> <a id="4293" href="stlc.norm.html#4231" class="Bound">Î“</a>
    <a id="4299" class="Comment">------------------</a>
  <a id="4320" class="Symbol">â†’</a> <a id="4322" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="4324" href="stlc.norm.html#4270" class="Bound">A</a> <a id="4326" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="4328" href="stlc.base.html#3339" class="Function">subst</a> <a id="4334" href="stlc.norm.html#4247" class="Bound">Ïƒ</a> <a id="4336" href="stlc.norm.html#4268" class="Bound">M</a> <a id="4338" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
</pre>
<ul>
<li>Case for variable, this is encoded in the definition.</li>
</ul>
<pre class="Agda"><a id="4410" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="4413" class="Symbol">(</a><a id="4414" href="stlc.base.html#4046" class="InductiveConstructor">âŠ¢var</a> <a id="4419" href="stlc.norm.html#4419" class="Bound">x</a><a id="4420" class="Symbol">)</a> <a id="4422" href="stlc.norm.html#4422" class="Bound">ÏƒâŠ¨Î“</a> <a id="4426" class="Symbol">=</a> <a id="4428" href="stlc.norm.html#4422" class="Bound">ÏƒâŠ¨Î“</a> <a id="4432" href="stlc.norm.html#4419" class="Bound">x</a>
</pre>
<ul>
<li>Case for lambda abstraction, we need to show that the term after substitution is also normalizing.</li>
</ul>
<pre class="Agda"><a id="4549" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="4552" class="Symbol">{</a><a id="4553" class="Argument">Ïƒ</a> <a id="4555" class="Symbol">=</a> <a id="4557" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="4558" class="Symbol">}</a> <a id="4560" class="Symbol">{</a><a id="4561" class="Argument">M</a> <a id="4563" class="Symbol">=</a> <a id="4565" href="stlc.base.html#1013" class="InductiveConstructor Operator">Æ›</a> <a id="4567" href="stlc.norm.html#4567" class="Bound">M</a><a id="4568" class="Symbol">}</a> <a id="4570" class="Symbol">{</a><a id="4571" class="Argument">A</a> <a id="4573" class="Symbol">=</a> <a id="4575" href="stlc.norm.html#4575" class="Bound">A</a> <a id="4577" href="stlc.base.html#628" class="InductiveConstructor Operator">â‡’</a> <a id="4579" href="stlc.norm.html#4579" class="Bound">B</a><a id="4580" class="Symbol">}</a> <a id="4582" class="Symbol">(</a><a id="4583" href="stlc.base.html#4119" class="InductiveConstructor">âŠ¢abs</a> <a id="4588" href="stlc.norm.html#4588" class="Bound">âŠ¢M</a><a id="4590" class="Symbol">)</a> <a id="4592" href="stlc.norm.html#4592" class="Bound">ÏƒâŠ¨Î“</a> <a id="4596" class="Symbol">=</a> <a id="4598" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="4605" class="Symbol">(</a><a id="4606" href="stlc.base.html#4119" class="InductiveConstructor">âŠ¢abs</a> <a id="4611" href="stlc.norm.html#4588" class="Bound">âŠ¢M</a><a id="4613" class="Symbol">)</a> <a id="4615" href="stlc.norm.html#4592" class="Bound">ÏƒâŠ¨Î“</a> <a id="4619" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4621" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="4627" class="Symbol">(</a><a id="4628" href="stlc.base.html#3339" class="Function">subst</a> <a id="4634" href="stlc.norm.html#4557" class="Bound">Ïƒ</a> <a id="4636" class="Symbol">(</a><a id="4637" href="stlc.base.html#1013" class="InductiveConstructor Operator">Æ›</a> <a id="4639" href="stlc.norm.html#4567" class="Bound">M</a><a id="4640" class="Symbol">)</a> <a id="4642" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="4643" class="Symbol">)</a> <a id="4645" href="stlc.base.html#4736" class="InductiveConstructor">V-abs</a> <a id="4651" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4653" href="stlc.norm.html#4667" class="Function">H</a>
  <a id="4657" class="Keyword">where</a>
    <a id="4667" href="stlc.norm.html#4667" class="Function">H</a> <a id="4669" class="Symbol">:</a> <a id="4671" class="Symbol">âˆ€</a> <a id="4673" class="Symbol">{</a><a id="4674" href="stlc.norm.html#4674" class="Bound">N</a><a id="4675" class="Symbol">}</a> <a id="4677" class="Symbol">â†’</a> <a id="4679" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="4681" href="stlc.norm.html#4575" class="Bound">A</a> <a id="4683" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="4685" href="stlc.norm.html#4674" class="Bound">N</a> <a id="4687" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a> <a id="4689" class="Symbol">â†’</a> <a id="4691" href="stlc.norm.html#1402" class="Function Operator">ğ’©</a> <a id="4693" href="stlc.norm.html#4579" class="Bound">B</a> <a id="4695" href="stlc.norm.html#1402" class="Function Operator">âŸ¦</a> <a id="4697" class="Symbol">(</a><a id="4698" href="stlc.base.html#1013" class="InductiveConstructor Operator">Æ›</a> <a id="4700" href="stlc.base.html#3339" class="Function">subst</a> <a id="4706" class="Symbol">(</a><a id="4707" href="stlc.base.html#3217" class="Function">exts</a> <a id="4712" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="4713" class="Symbol">)</a> <a id="4715" href="stlc.norm.html#4567" class="Bound">M</a><a id="4716" class="Symbol">)</a> <a id="4718" href="stlc.base.html#1079" class="InductiveConstructor Operator">Â·</a> <a id="4720" href="stlc.norm.html#4674" class="Bound">N</a> <a id="4722" href="stlc.norm.html#1402" class="Function Operator">âŸ§</a>
    <a id="4728" href="stlc.norm.html#4667" class="Function">H</a> <a id="4730" class="Symbol">{</a><a id="4731" href="stlc.norm.html#4731" class="Bound">N</a><a id="4732" class="Symbol">}</a> <a id="4734" href="stlc.norm.html#4734" class="Bound">nn</a> <a id="4737" class="Keyword">with</a> <a id="4742" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="4748" class="Symbol">{</a><a id="4749" class="Argument">N</a> <a id="4751" class="Symbol">=</a> <a id="4753" href="stlc.norm.html#4753" class="Bound">N&#39;</a><a id="4755" class="Symbol">}</a> <a id="4757" href="stlc.norm.html#4757" class="Bound">Nâ€”â†’*N&#39;</a> <a id="4764" href="stlc.norm.html#4764" class="Bound">VN&#39;</a> â† <a id="4770" href="stlc.norm.html#4023" class="Function">ğ’©-halts</a> <a id="4778" href="stlc.norm.html#4734" class="Bound">nn</a>
      <a id="4787" class="Symbol">=</a> <a id="4789" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="4796" class="Symbol">(</a><a id="4797" href="stlc.base.html#4207" class="InductiveConstructor">âŠ¢app</a> <a id="4802" class="Symbol">(</a><a id="4803" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="4810" class="Symbol">(</a><a id="4811" href="stlc.base.html#4119" class="InductiveConstructor">âŠ¢abs</a> <a id="4816" href="stlc.norm.html#4588" class="Bound">âŠ¢M</a><a id="4818" class="Symbol">)</a> <a id="4820" href="stlc.norm.html#4592" class="Bound">ÏƒâŠ¨Î“</a><a id="4823" class="Symbol">)</a> <a id="4825" class="Symbol">(</a><a id="4826" href="stlc.norm.html#1801" class="Function">ğ’©â†’âŠ¢</a> <a id="4830" href="stlc.norm.html#4734" class="Bound">nn</a><a id="4832" class="Symbol">))</a> <a id="4835" href="stlc.norm.html#4913" class="Function">lemma</a> <a id="4841" class="Symbol">(</a><a id="4842" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="4845" href="stlc.norm.html#4588" class="Bound">âŠ¢M</a> <a id="4848" class="Symbol">(Î»</a> <a id="4851" class="Symbol">{</a> <a id="4853" href="stlc.base.html#2230" class="InductiveConstructor">Z</a> <a id="4855" class="Symbol">â†’</a> <a id="4857" href="stlc.norm.html#3560" class="Function">â€”â†’*-ğ’©</a> <a id="4863" href="stlc.norm.html#4757" class="Bound">Nâ€”â†’*N&#39;</a> <a id="4870" href="stlc.norm.html#4734" class="Bound">nn</a> <a id="4873" class="Symbol">;</a> <a id="4875" class="Symbol">(</a><a id="4876" href="stlc.base.html#2310" class="InductiveConstructor">S</a> <a id="4878" href="stlc.norm.html#4878" class="Bound">x</a><a id="4879" class="Symbol">)</a> <a id="4881" class="Symbol">â†’</a> <a id="4883" href="stlc.norm.html#4592" class="Bound">ÏƒâŠ¨Î“</a> <a id="4887" href="stlc.norm.html#4878" class="Bound">x</a> <a id="4889" class="Symbol">}))</a>
      <a id="4899" class="Keyword">where</a>
        <a id="4913" href="stlc.norm.html#4913" class="Function">lemma</a> <a id="4919" class="Symbol">:</a> <a id="4921" class="Symbol">(</a><a id="4922" href="stlc.base.html#1013" class="InductiveConstructor Operator">Æ›</a> <a id="4924" href="stlc.base.html#3339" class="Function">subst</a> <a id="4930" class="Symbol">(</a><a id="4931" href="stlc.base.html#3217" class="Function">exts</a> <a id="4936" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="4937" class="Symbol">)</a> <a id="4939" href="stlc.norm.html#4567" class="Bound">M</a><a id="4940" class="Symbol">)</a> <a id="4942" href="stlc.base.html#1079" class="InductiveConstructor Operator">Â·</a> <a id="4944" href="stlc.norm.html#4731" class="Bound">N</a> <a id="4946" href="stlc.base.html#5632" class="Datatype Operator">â€”â†’*</a> <a id="4950" href="stlc.base.html#3339" class="Function">subst</a> <a id="4956" class="Symbol">(</a><a id="4957" href="stlc.norm.html#4753" class="Bound">N&#39;</a> <a id="4960" href="stlc.subst.html#1324" class="Function Operator">â€¢</a> <a id="4962" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="4963" class="Symbol">)</a> <a id="4965" href="stlc.norm.html#4567" class="Bound">M</a>
        <a id="4975" href="stlc.norm.html#4913" class="Function">lemma</a> <a id="4981" class="Keyword">rewrite</a> <a id="4989" href="stlc.subst.html#15017" class="Function">sub-ext-sub</a> <a id="5001" class="Symbol">{</a><a id="5002" class="Argument">Ïƒ</a> <a id="5004" class="Symbol">=</a> <a id="5006" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="5007" class="Symbol">}</a> <a id="5009" class="Symbol">{</a><a id="5010" class="Argument">M</a> <a id="5012" class="Symbol">=</a> <a id="5014" href="stlc.norm.html#4567" class="Bound">M</a><a id="5015" class="Symbol">}</a> <a id="5017" class="Symbol">{</a><a id="5018" class="Argument">N</a> <a id="5020" class="Symbol">=</a> <a id="5022" href="stlc.norm.html#4753" class="Bound">N&#39;</a><a id="5024" class="Symbol">}</a>
          <a id="5036" class="Symbol">=</a> <a id="5038" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="5048" class="Symbol">(</a><a id="5049" href="stlc.prop.html#7073" class="Function">appR-cong</a> <a id="5059" href="stlc.norm.html#4757" class="Bound">Nâ€”â†’*N&#39;</a><a id="5065" class="Symbol">)</a> <a id="5067" class="Symbol">((</a><a id="5069" href="stlc.base.html#1013" class="InductiveConstructor Operator">Æ›</a> <a id="5071" href="stlc.base.html#3339" class="Function">subst</a> <a id="5077" class="Symbol">(</a><a id="5078" href="stlc.base.html#3217" class="Function">exts</a> <a id="5083" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="5084" class="Symbol">)</a> <a id="5086" href="stlc.norm.html#4567" class="Bound">M</a><a id="5087" class="Symbol">)</a> <a id="5089" href="stlc.base.html#1079" class="InductiveConstructor Operator">Â·</a> <a id="5091" href="stlc.norm.html#4753" class="Bound">N&#39;</a> <a id="5094" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="5098" href="stlc.base.html#5095" class="InductiveConstructor">Î²-abs</a> <a id="5104" href="stlc.norm.html#4764" class="Bound">VN&#39;</a> <a id="5108" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="5110" class="Symbol">(</a><a id="5111" href="stlc.base.html#3339" class="Function">subst</a> <a id="5117" class="Symbol">(</a><a id="5118" href="stlc.base.html#3217" class="Function">exts</a> <a id="5123" href="stlc.norm.html#4557" class="Bound">Ïƒ</a><a id="5124" class="Symbol">)</a> <a id="5126" href="stlc.norm.html#4567" class="Bound">M</a> <a id="5128" href="stlc.base.html#3805" class="Function Operator">[</a> <a id="5130" href="stlc.norm.html#4753" class="Bound">N&#39;</a> <a id="5133" href="stlc.base.html#3805" class="Function Operator">]</a><a id="5134" class="Symbol">)</a> <a id="5136" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="5137" class="Symbol">)</a>
</pre>
<ul>
<li>Case for application, normalization is encoded in the logical relation predicate.</li>
</ul>
<pre class="Agda"><a id="5237" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5240" class="Symbol">(</a><a id="5241" href="stlc.base.html#4207" class="InductiveConstructor">âŠ¢app</a> <a id="5246" href="stlc.norm.html#5246" class="Bound">âŠ¢M</a> <a id="5249" href="stlc.norm.html#5249" class="Bound">âŠ¢N</a><a id="5251" class="Symbol">)</a> <a id="5253" href="stlc.norm.html#5253" class="Bound">ÏƒâŠ¨Î“</a> <a id="5257" class="Keyword">with</a> <a id="5262" href="stlc.norm.html#5262" class="Bound">âŠ¢ÏƒM</a> <a id="5266" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5268" href="stlc.norm.html#5268" class="Bound">HÏƒM</a> <a id="5272" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5274" href="stlc.norm.html#5274" class="Bound">H</a> â† <a id="5278" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5281" href="stlc.norm.html#5246" class="Bound">âŠ¢M</a> <a id="5284" href="stlc.norm.html#5253" class="Bound">ÏƒâŠ¨Î“</a> <a id="5288" class="Symbol">=</a> <a id="5290" href="stlc.norm.html#5274" class="Bound">H</a> <a id="5292" class="Symbol">(</a><a id="5293" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5296" href="stlc.norm.html#5249" class="Bound">âŠ¢N</a> <a id="5299" href="stlc.norm.html#5253" class="Bound">ÏƒâŠ¨Î“</a><a id="5302" class="Symbol">)</a>
</pre>
<ul>
<li>Case for <code>true</code> and <code>false</code>.</li>
</ul>
<pre class="Agda"><a id="5349" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5352" class="Symbol">{</a><a id="5353" class="Argument">Ïƒ</a> <a id="5355" class="Symbol">=</a> <a id="5357" href="stlc.norm.html#5357" class="Bound">Ïƒ</a><a id="5358" class="Symbol">}</a> <a id="5360" href="stlc.base.html#4308" class="InductiveConstructor">âŠ¢true</a>  <a id="5367" href="stlc.norm.html#5367" class="Bound">ÏƒâŠ¨Î“</a> <a id="5371" class="Symbol">=</a> <a id="5373" href="stlc.base.html#4308" class="InductiveConstructor">âŠ¢true</a> <a id="5379" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5381" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="5387" class="Symbol">(</a><a id="5388" href="stlc.base.html#3339" class="Function">subst</a> <a id="5394" href="stlc.norm.html#5357" class="Bound">Ïƒ</a> <a id="5396" href="stlc.base.html#1147" class="InductiveConstructor">true</a> <a id="5401" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="5402" class="Symbol">)</a> <a id="5404" href="stlc.base.html#4768" class="InductiveConstructor">V-true</a>
<a id="5411" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5414" class="Symbol">{</a><a id="5415" class="Argument">Ïƒ</a> <a id="5417" class="Symbol">=</a> <a id="5419" href="stlc.norm.html#5419" class="Bound">Ïƒ</a><a id="5420" class="Symbol">}</a> <a id="5422" href="stlc.base.html#4370" class="InductiveConstructor">âŠ¢false</a> <a id="5429" href="stlc.norm.html#5429" class="Bound">ÏƒâŠ¨Î“</a> <a id="5433" class="Symbol">=</a> <a id="5435" href="stlc.base.html#4370" class="InductiveConstructor">âŠ¢false</a> <a id="5442" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5444" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="5450" class="Symbol">(</a><a id="5451" href="stlc.base.html#3339" class="Function">subst</a> <a id="5457" href="stlc.norm.html#5419" class="Bound">Ïƒ</a> <a id="5459" href="stlc.base.html#1164" class="InductiveConstructor">false</a> <a id="5465" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="5466" class="Symbol">)</a> <a id="5468" href="stlc.base.html#4791" class="InductiveConstructor">V-false</a>
</pre>
<ul>
<li>Case for <code>if</code>, we know that the condition <code>L</code> is normalizing, so it will reduce to either <code>true</code> or <code>false</code>.
Then we can proceed with either branch.</li>
</ul>
<pre class="Agda"><a id="5641" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5644" class="Symbol">{</a><a id="5645" class="Argument">Ïƒ</a> <a id="5647" class="Symbol">=</a> <a id="5649" href="stlc.norm.html#5649" class="Bound">Ïƒ</a><a id="5650" class="Symbol">}</a> <a id="5652" class="Symbol">{</a><a id="5653" class="Argument">M</a> <a id="5655" class="Symbol">=</a> <a id="5657" href="stlc.base.html#1181" class="InductiveConstructor">if</a> <a id="5660" href="stlc.norm.html#5660" class="Bound">L</a> <a id="5662" href="stlc.norm.html#5662" class="Bound">M</a> <a id="5664" href="stlc.norm.html#5664" class="Bound">N</a><a id="5665" class="Symbol">}</a> <a id="5667" class="Symbol">{</a><a id="5668" class="Argument">A</a> <a id="5670" class="Symbol">=</a> <a id="5672" href="stlc.norm.html#5672" class="Bound">A</a><a id="5673" class="Symbol">}</a> <a id="5675" class="Symbol">(</a><a id="5676" href="stlc.base.html#4435" class="InductiveConstructor">âŠ¢if</a> <a id="5680" href="stlc.norm.html#5680" class="Bound">âŠ¢L</a> <a id="5683" href="stlc.norm.html#5683" class="Bound">âŠ¢M</a> <a id="5686" href="stlc.norm.html#5686" class="Bound">âŠ¢N</a><a id="5688" class="Symbol">)</a> <a id="5690" href="stlc.norm.html#5690" class="Bound">ÏƒâŠ¨Î“</a> <a id="5694" class="Keyword">with</a> <a id="5699" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="5702" href="stlc.norm.html#5680" class="Bound">âŠ¢L</a> <a id="5705" href="stlc.norm.html#5690" class="Bound">ÏƒâŠ¨Î“</a>
<a id="5709" class="Symbol">...</a> <a id="5713" class="Symbol">|</a> <a id="5715" href="stlc.norm.html#5715" class="Bound">âŠ¢ÏƒL</a> <a id="5719" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5721" href="stlc.norm.html#1277" class="InductiveConstructor">halts</a> <a id="5727" class="Symbol">{</a><a id="5728" class="Argument">N</a> <a id="5730" class="Symbol">=</a> <a id="5732" href="stlc.norm.html#5732" class="Bound">L&#39;</a><a id="5734" class="Symbol">}</a> <a id="5736" href="stlc.norm.html#5736" class="Bound">Lâ€”â†’*L&#39;</a> <a id="5743" href="stlc.norm.html#5743" class="Bound">VL</a> 
    <a id="5751" class="Keyword">with</a> <a id="5756" href="stlc.prop.html#4542" class="Function">Canonical-Bool</a> <a id="5771" class="Symbol">(</a><a id="5772" href="stlc.prop.html#6201" class="Function">â€”â†’*-pres</a> <a id="5781" href="stlc.norm.html#5715" class="Bound">âŠ¢ÏƒL</a> <a id="5785" href="stlc.norm.html#5736" class="Bound">Lâ€”â†’*L&#39;</a><a id="5791" class="Symbol">)</a> <a id="5793" href="stlc.norm.html#5743" class="Bound">VL</a>
<a id="5796" class="Symbol">...</a> <a id="5800" class="Symbol">|</a> <a id="5802" href="Data.Sum.Base.html#675" class="InductiveConstructor">injâ‚</a> <a id="5807" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5812" class="Symbol">=</a> <a id="5814" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="5821" class="Symbol">(</a><a id="5822" href="stlc.base.html#4435" class="InductiveConstructor">âŠ¢if</a> <a id="5826" class="Bound">âŠ¢ÏƒL</a> <a id="5830" class="Symbol">(</a><a id="5831" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="5838" class="Bound">âŠ¢M</a> <a id="5841" class="Bound">ÏƒâŠ¨Î“</a><a id="5844" class="Symbol">)</a> <a id="5846" class="Symbol">(</a><a id="5847" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="5854" class="Bound">âŠ¢N</a> <a id="5857" class="Bound">ÏƒâŠ¨Î“</a><a id="5860" class="Symbol">))</a>
                         <a id="5888" class="Symbol">(</a><a id="5889" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="5899" class="Symbol">(</a><a id="5900" href="stlc.prop.html#7302" class="Function">if-cong</a> <a id="5908" class="Bound">Lâ€”â†’*L&#39;</a><a id="5914" class="Symbol">)</a> <a id="5916" class="Symbol">(</a><a id="5917" href="stlc.base.html#1181" class="InductiveConstructor">if</a> <a id="5920" href="stlc.base.html#1147" class="InductiveConstructor">true</a> <a id="5925" class="Symbol">(</a><a id="5926" href="stlc.base.html#3339" class="Function">subst</a> <a id="5932" class="Bound">Ïƒ</a> <a id="5934" class="Bound">M</a><a id="5935" class="Symbol">)</a> <a id="5937" class="Symbol">(</a><a id="5938" href="stlc.base.html#3339" class="Function">subst</a> <a id="5944" class="Bound">Ïƒ</a> <a id="5946" class="Bound">N</a><a id="5947" class="Symbol">)</a> <a id="5949" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="5953" href="stlc.base.html#5277" class="InductiveConstructor">Î²-ifâ‚</a> <a id="5959" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="5961" href="stlc.base.html#3339" class="Function">subst</a> <a id="5967" class="Bound">Ïƒ</a> <a id="5969" class="Bound">M</a> <a id="5971" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="5972" class="Symbol">))</a> 
                         <a id="6001" class="Symbol">(</a><a id="6002" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="6005" class="Bound">âŠ¢M</a> <a id="6008" class="Bound">ÏƒâŠ¨Î“</a><a id="6011" class="Symbol">)</a>
<a id="6013" class="Symbol">...</a> <a id="6017" class="Symbol">|</a> <a id="6019" href="Data.Sum.Base.html#700" class="InductiveConstructor">injâ‚‚</a> <a id="6024" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6029" class="Symbol">=</a> <a id="6031" href="stlc.norm.html#3716" class="Function">â€”â†’*-ğ’©&#39;</a> <a id="6038" class="Symbol">(</a><a id="6039" href="stlc.base.html#4435" class="InductiveConstructor">âŠ¢if</a> <a id="6043" class="Bound">âŠ¢ÏƒL</a> <a id="6047" class="Symbol">(</a><a id="6048" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="6055" class="Bound">âŠ¢M</a> <a id="6058" class="Bound">ÏƒâŠ¨Î“</a><a id="6061" class="Symbol">)</a> <a id="6063" class="Symbol">(</a><a id="6064" href="stlc.norm.html#2253" class="Function">âŠ¢subst</a> <a id="6071" class="Bound">âŠ¢N</a> <a id="6074" class="Bound">ÏƒâŠ¨Î“</a><a id="6077" class="Symbol">))</a>
                         <a id="6105" class="Symbol">(</a><a id="6106" href="stlc.prop.html#5938" class="Function">â€”â†’*-trans</a> <a id="6116" class="Symbol">(</a><a id="6117" href="stlc.prop.html#7302" class="Function">if-cong</a> <a id="6125" class="Bound">Lâ€”â†’*L&#39;</a><a id="6131" class="Symbol">)</a> <a id="6133" class="Symbol">(</a><a id="6134" href="stlc.base.html#1181" class="InductiveConstructor">if</a> <a id="6137" href="stlc.base.html#1164" class="InductiveConstructor">false</a> <a id="6143" class="Symbol">(</a><a id="6144" href="stlc.base.html#3339" class="Function">subst</a> <a id="6150" class="Bound">Ïƒ</a> <a id="6152" class="Bound">M</a><a id="6153" class="Symbol">)</a> <a id="6155" class="Symbol">(</a><a id="6156" href="stlc.base.html#3339" class="Function">subst</a> <a id="6162" class="Bound">Ïƒ</a> <a id="6164" class="Bound">N</a><a id="6165" class="Symbol">)</a> <a id="6167" href="stlc.base.html#5849" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="6171" href="stlc.base.html#5343" class="InductiveConstructor">Î²-ifâ‚‚</a> <a id="6177" href="stlc.base.html#5849" class="InductiveConstructor Operator">âŸ©</a> <a id="6179" href="stlc.base.html#3339" class="Function">subst</a> <a id="6185" class="Bound">Ïƒ</a> <a id="6187" class="Bound">N</a> <a id="6189" href="stlc.base.html#5676" class="InductiveConstructor Operator">âˆ</a><a id="6190" class="Symbol">))</a> 
                         <a id="6219" class="Symbol">(</a><a id="6220" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="6223" class="Bound">âŠ¢N</a> <a id="6226" class="Bound">ÏƒâŠ¨Î“</a><a id="6229" class="Symbol">)</a>
</pre>
<h2>Normalization</h2>
<pre class="Agda"><a id="norm"></a><a id="6262" href="stlc.norm.html#6262" class="Function">norm</a> <a id="6267" class="Symbol">:</a> <a id="6269" class="Symbol">âˆ€</a> <a id="6271" class="Symbol">{</a><a id="6272" href="stlc.norm.html#6272" class="Bound">M</a> <a id="6274" href="stlc.norm.html#6274" class="Bound">A</a><a id="6275" class="Symbol">}</a> <a id="6277" class="Symbol">â†’</a> <a id="6279" href="stlc.base.html#1972" class="InductiveConstructor">âˆ…</a> <a id="6281" href="stlc.base.html#3993" class="Datatype Operator">âŠ¢</a> <a id="6283" href="stlc.norm.html#6272" class="Bound">M</a> <a id="6285" href="stlc.base.html#3993" class="Datatype Operator">â¦‚</a> <a id="6287" href="stlc.norm.html#6274" class="Bound">A</a> <a id="6289" class="Symbol">â†’</a> <a id="6291" href="stlc.norm.html#1240" class="Datatype">Halts</a> <a id="6297" href="stlc.norm.html#6272" class="Bound">M</a>
<a id="6299" href="stlc.norm.html#6262" class="Function">norm</a> <a id="6304" class="Symbol">{</a><a id="6305" class="Argument">M</a> <a id="6307" class="Symbol">=</a> <a id="6309" href="stlc.norm.html#6309" class="Bound">M</a><a id="6310" class="Symbol">}</a> <a id="6312" href="stlc.norm.html#6312" class="Bound">âŠ¢M</a> <a id="6315" class="Keyword">with</a> <a id="6320" href="stlc.norm.html#4023" class="Function">ğ’©-halts</a> <a id="6328" class="Symbol">(</a><a id="6329" href="stlc.norm.html#4219" class="Function">âŠ¢ğ’©</a> <a id="6332" class="Symbol">{</a><a id="6333" class="Argument">Ïƒ</a> <a id="6335" class="Symbol">=</a> <a id="6337" href="stlc.subst.html#1244" class="Function">ids</a><a id="6340" class="Symbol">}</a> <a id="6342" href="stlc.norm.html#6312" class="Bound">âŠ¢M</a> <a id="6345" class="Symbol">(Î»</a> <a id="6348" class="Symbol">()))</a>
<a id="6353" class="Symbol">...</a> <a id="6357" class="Symbol">|</a> <a id="6359" href="stlc.norm.html#6359" class="Bound">HM</a> <a id="6362" class="Keyword">rewrite</a> <a id="6370" href="stlc.subst.html#7398" class="Function">sub-id</a> <a id="6377" class="Symbol">{</a><a id="6378" class="Argument">M</a> <a id="6380" class="Symbol">=</a> <a id="6382" class="Bound">M</a><a id="6383" class="Symbol">}</a> <a id="6385" class="Symbol">=</a> <a id="6387" href="stlc.norm.html#6359" class="Bound">HM</a>
</pre>
    </main>
  </div>
</body>

</html>